import AsyncStorage from '@react-native-async-storage/async-storage';
import DateTimePicker from '@react-native-community/datetimepicker';
import { BlurView } from 'expo-blur';
import * as Contacts from 'expo-contacts';
import * as ImageManipulator from 'expo-image-manipulator';
import * as ImagePicker from 'expo-image-picker';
import * as Notifications from 'expo-notifications';
import * as SMS from 'expo-sms';
import {
    AlarmClock,
    AlertCircle,
    AlignLeft,
    Bell,
    Calendar,
    CalendarClock,
    CalendarDays,
    Check,
    CheckCircle2,
    ChevronDown,
    ChevronLeft, ChevronRight,
    ChevronUp,
    Edit2,
    Flame,
    Globe,
    Layers,
    ListTodo,
    Lock,
    LogOut, Mail,
    MessageCircle,
    Monitor,
    Moon,
    Plus,
    Repeat,
    Search,
    Send,
    Share2, Sliders,
    Sun,
    Trash2,
    Trophy,
    User,
    UserCheck,
    UserPlus,
    Users,
    X,
    XCircle
} from 'lucide-react-native';
import React, { useEffect, useState } from 'react';
import {
    ActivityIndicator,
    Alert,
    FlatList, Image,
    Keyboard,
    KeyboardAvoidingView,
    LayoutAnimation,
    Linking,
    Modal,
    Platform,
    SafeAreaView,
    ScrollView, StatusBar,
    StyleSheet,
    Switch,
    Text,
    TextInput, TouchableOpacity,
    TouchableWithoutFeedback,
    UIManager,
    useColorScheme,
    View
} from 'react-native';

// --- FIREBASE ---
// @ts-ignore

import * as AppleAuthentication from 'expo-apple-authentication';
import * as Google from 'expo-auth-session/providers/google';
import {
    createUserWithEmailAndPassword,
    getAuth,
    GoogleAuthProvider,
    OAuthProvider,
    onAuthStateChanged,
    sendPasswordResetEmail,
    signInWithCredential,
    signInWithEmailAndPassword,
    signOut,
    updateProfile
} from 'firebase/auth';

import { initializeApp } from "firebase/app";
import {
    addDoc,
    arrayRemove,
    arrayUnion,
    collection,
    deleteDoc, doc,
    getDocs,
    getFirestore,
    limit,
    onSnapshot,
    orderBy,
    query,
    serverTimestamp,
    setDoc,
    updateDoc,
    where
} from 'firebase/firestore';
// Auth tipini gÃ¼venli hale getiriyoruz

import * as WebBrowser from 'expo-web-browser';

// Widget (Android)
// @ts-ignore
import { requestWidgetUpdate } from 'react-native-android-widget';
// @ts-ignore
import { widgetTaskHandler } from '@/widget-task-handler';
WebBrowser.maybeCompleteAuthSession();

if (Platform.OS === 'android' && UIManager.setLayoutAnimationEnabledExperimental) {
  UIManager.setLayoutAnimationEnabledExperimental(true);
}
const COLORS = {
  primary: '#6366f1', secondary: '#a5b4fc', background: '#F8FAFC', surface: '#ffffff',
  textDark: '#1e293b', textLight: '#64748b', textMuted: '#94a3b8',
  success: '#10b981', danger: '#ef4444', warning: '#f59e0b', darkBg: '#0f172a', darkSurface: '#1e293b',
};
const firebaseConfig = {
  apiKey: "AIzaSyCKClbJrNCzTgNPsy9JcAMgmGpP1hQ1Ts4",
  authDomain: "ommio-30d72.firebaseapp.com",
  projectId: "ommio-30d72",
  storageBucket: "ommio-30d72.firebasestorage.app",
  messagingSenderId: "677937409612",
  appId: "1:677937409612:web:09e17f70f5e1a8904d0ee9",
  measurementId: "G-V7WP221WRP"
};
const app = initializeApp(firebaseConfig);

// YENÄ° KISIM (Standart YÃ¶ntem)
const auth = getAuth(app);

// VeritabanÄ± baÅŸlatma
const db = getFirestore(app);
const CATEGORY_COLORS = [
  { id: 'blue', hex: '#3b82f6', bg: '#eff6ff' },
  { id: 'orange', hex: '#f97316', bg: '#fff7ed' },
  { id: 'green', hex: '#10b981', bg: '#f0fdf4' },
  { id: 'purple', hex: '#a855f7', bg: '#faf5ff' },
  { id: 'pink', hex: '#ec4899', bg: '#fdf2f8' },
];

Notifications.setNotificationHandler({
  handleNotification: async () => ({ shouldShowAlert: true, shouldPlaySound: true, shouldSetBadge: false, shouldShowBanner: true, shouldShowList: true }),
});

const LANGUAGES = [{ code: 'en', label: 'English', flag: 'ðŸ‡¬ðŸ‡§' }, { code: 'tr', label: 'TÃ¼rkÃ§e', flag: 'ðŸ‡¹ðŸ‡·' }, { code: 'nl', label: 'Dutch', flag: 'ðŸ‡³ðŸ‡±' }, { code: 'de', label: 'German', flag: 'ðŸ‡©ðŸ‡ª' }, { code: 'es', label: 'Spanish', flag: 'ðŸ‡ªðŸ‡¸' }, { code: 'fr', label: 'French', flag: 'ðŸ‡«ðŸ‡·' }, { code: 'ar', label: 'Arabic', flag: 'ðŸ‡¸ðŸ‡¦' }, { code: 'id', label: 'Indonesian', flag: 'ðŸ‡®ðŸ‡©' }, { code: 'pt', label: 'Portuguese', flag: 'ðŸ‡µðŸ‡¹' }, { code: 'hi', label: 'Hindi', flag: 'ðŸ‡®ðŸ‡³' }, { code: 'ko', label: 'Korean', flag: 'ðŸ‡°ðŸ‡·' }, { code: 'ja', label: 'Japanese', flag: 'ðŸ‡¯ðŸ‡µ' }, { code: 'ru', label: 'Russian', flag: 'ðŸ‡·ðŸ‡º' }, { code: 'it', label: 'Italian', flag: 'ðŸ‡®ðŸ‡¹' }, { code: 'pl', label: 'Polish', flag: 'ðŸ‡µðŸ‡±' }, { code: 'uk', label: 'Ukrainian', flag: 'ðŸ‡ºðŸ‡¦' }];

const TRANSLATIONS = {
  en:{categories_title:"Categories",category_name_placeholder:"Category name...",edit_categories:"Edit categories",at_least_one_category:"At least one category must remain.",ok_btn:"OK",warning_label:"Warning",delete_label:"Delete",title_label:"Title",add_note_placeholder:"Add a note...",which_days:"Which days?",category:"Category",delete_habit_confirm:"Do you want to delete this habit?",motivational_daily:"Be 1% better every day.",connections:"Connections",close:"Close",me:"Me",work:"Work",personal:"Personal",home:"Home",habit_name_label:"Habit name",time_placeholder:"Time (09:00)",every_day_label:"Every Day",weekly_label:"Weekly",day_label:"Day",start_habit:"Start Habit",no_connections:"You have no connections yet.",friends:"Friends",no_users:"No users yet.",search_username:"Search Username...",find_from_contacts:"Find from Contacts",contacts_loading_or_denied:"Contacts loading or permission denied.",theme_light:"Light",theme_dark:"Dark",theme_system:"System",
      welcome:"Welcome",addTask:"Add a new task...",habits:"Habits",stats:"Stats",settings:"Settings",appearance:"Appearance",language:"Language",logout:"Log out",assign_to:"Assign to",description:"Description",start_date:"Start date",due_date:"Due date",daily:"Daily",weekly:"Weekly",new_habit:"New habit",habit_name:"Habit name",frequency:"Frequency",days:"Days",end_date:"End date",time:"Time",create:"Create",cancel:"Cancel",save:"Save",delete:"Delete",edit:"Edit",completed:"Completed",search_contact:"Search contact...",notification:"Notification",alarm:"Alarm",every_day:"Every day",change_photo:"Change photo",today: "Today",all_good: "All good!",no_tasks_today: "Add a plan for today.",tasks_tab:"Tasks",habits_tab:"Habits",messages_tab:"Messages",social_tab:"Social",profile_tab:"Profile",},
  tr:{categories_title:"Kategoriler",category_name_placeholder:"Kategori adÄ±...",edit_categories:"Kategorileri dÃ¼zenle",at_least_one_category:"En az bir kategori kalmalÄ±dÄ±r.",ok_btn:"Tamam",warning_label:"UyarÄ±",delete_label:"Sil",title_label:"BaÅŸlÄ±k",add_note_placeholder:"Not ekle...",which_days:"Hangi gÃ¼nler?",category:"Kategori",delete_habit_confirm:"Bu alÄ±ÅŸkanlÄ±ÄŸÄ± silmek istiyor musun?",motivational_daily:"Her gÃ¼n %1 daha iyi ol.",connections:"BaÄŸlantÄ±lar",close:"Kapat",me:"Ben",work:"Ä°ÅŸ",personal:"KiÅŸisel",home:"Ev",habit_name_label:"AlÄ±ÅŸkanlÄ±k adÄ±",time_placeholder:"Saat (09:00)",every_day_label:"Her gÃ¼n",weekly_label:"HaftalÄ±k",day_label:"GÃ¼n",start_habit:"AlÄ±ÅŸkanlÄ±ÄŸÄ± BaÅŸlat",no_connections:"HenÃ¼z kimseyle baÄŸlantÄ±n yok.",friends:"ArkadaÅŸlar",no_users:"HenÃ¼z kimse yok.",search_username:"KullanÄ±cÄ± AdÄ± Ara...",find_from_contacts:"Rehberden Bul",contacts_loading_or_denied:"Rehber yÃ¼kleniyor veya izin verilmedi.",theme_light:"AÃ§Ä±k",theme_dark:"Koyu",theme_system:"Sistem",
      welcome:"HoÅŸ geldin",addTask:"Yeni bir gÃ¶rev ekle...",habits:"AlÄ±ÅŸkanlÄ±klar",stats:"Ã–zet",settings:"Ayarlar",appearance:"GÃ¶rÃ¼nÃ¼m",language:"Dil",logout:"Ã‡Ä±kÄ±ÅŸ yap",assign_to:"Kime",description:"AÃ§Ä±klama",start_date:"BaÅŸlangÄ±Ã§",due_date:"Son tarih",daily:"Her gÃ¼n",weekly:"HaftalÄ±k",new_habit:"Yeni alÄ±ÅŸkanlÄ±k",habit_name:"AlÄ±ÅŸkanlÄ±k adÄ±",frequency:"SÄ±klÄ±k",days:"GÃ¼nler",end_date:"BitiÅŸ tarihi",time:"Saat",create:"OluÅŸtur",cancel:"Ä°ptal",save:"Kaydet",delete:"Sil",edit:"DÃ¼zenle",completed:"Tamamlananlar",search_contact:"KiÅŸi ara...",notification:"Bildirim",alarm:"Alarm",every_day:"Her gÃ¼n",change_photo:"FotoÄŸraf deÄŸiÅŸtir",today: "BugÃ¼n",all_good: "Her ÅŸey yolunda!",no_tasks_today: "BugÃ¼n iÃ§in plan ekle.",tasks_tab:"GÃ¶revler",habits_tab:"AlÄ±ÅŸkanlÄ±k",messages_tab:"Mesajlar",social_tab:"Sosyal",profile_tab:"Profil",},
  nl:{categories_title:"CategorieÃ«n",category_name_placeholder:"Categorienaam...",edit_categories:"CategorieÃ«n bewerken",at_least_one_category:"Er moet minstens Ã©Ã©n categorie overblijven.",ok_btn:"OK",warning_label:"Waarschuwing",delete_label:"Verwijderen",title_label:"Titel",add_note_placeholder:"Notitie toevoegen...",which_days:"Welke dagen?",category:"Categorie",delete_habit_confirm:"Wil je deze gewoonte verwijderen?",motivational_daily:"Word elke dag 1% beter.",connections:"Verbindingen",close:"Sluiten",me:"Ik",work:"Werk",personal:"Persoonlijk",home:"Thuis",habit_name_label:"Gewoonte naam",time_placeholder:"Tijd (09:00)",every_day_label:"Elke dag",weekly_label:"Wekelijks",day_label:"Dag",start_habit:"Gewoonte starten",    no_connections:"Je hebt nog geen connecties.",friends:"Vrienden",no_users:"Nog geen gebruikers.",search_username:"Gebruikersnaam zoeken...",find_from_contacts:"Zoek vanuit contacten",contacts_loading_or_denied:"Contacten laden of toestemming geweigerd.",theme_light:"Licht",theme_dark:"Donker",theme_system:"Systeem",
      welcome:"Welkom",addTask:"Voeg een nieuwe taak toe...",habits:"Gewoontes",stats:"Statistieken",settings:"Instellingen",appearance:"Weergave",language:"Taal",logout:"Uitloggen",assign_to:"Toewijzen aan",description:"Beschrijving",start_date:"Startdatum",due_date:"Einddatum",daily:"Dagelijks",weekly:"Wekelijks",new_habit:"Nieuwe gewoonte",habit_name:"Gewoonte naam",frequency:"Frequentie",days:"Dagen",end_date:"Einddatum",time:"Tijd",create:"Aanmaken",cancel:"Annuleren",save:"Opslaan",delete:"Verwijderen",edit:"Bewerken",completed:"Voltooid",search_contact:"Contact zoeken...",notification:"Notificatie",alarm:"Alarm",every_day:"Elke dag",change_photo:"Foto wijzigen",today: "Vandaag",all_good: "Alles is in orde!",no_tasks_today: "Voeg een plan toe voor vandaag.",tasks_tab:"Taken",habits_tab:"Gewoontes",messages_tab:"Berichten",social_tab:"Sociaal",profile_tab:"Profiel",},
  de:{categories_title:"Kategorien",category_name_placeholder:"Kategoriename...",edit_categories:"Kategorien bearbeiten",at_least_one_category:"Mindestens eine Kategorie muss bestehen bleiben.",ok_btn:"OK",warning_label:"Warnung",delete_label:"LÃ¶schen",title_label:"Titel",add_note_placeholder:"Notiz hinzufÃ¼gen...",which_days:"Welche Tage?",category:"Kategorie",delete_habit_confirm:"MÃ¶chtest du diese Gewohnheit lÃ¶schen?",motivational_daily:"Werde jeden Tag 1% besser.",connections:"Verbindungen",close:"SchlieÃŸen",me:"Ich",work:"Arbeit",personal:"PersÃ¶nlich",home:"Zuhause",habit_name_label:"Gewohnheitsname",time_placeholder:"Zeit (09:00)",every_day_label:"Jeden Tag",weekly_label:"WÃ¶chentlich",day_label:"Tag",start_habit:"Gewohnheit starten",no_connections:"Du hast noch keine Verbindungen.",friends:"Freunde",no_users:"Noch keine Nutzer.",search_username:"Benutzername suchen...",find_from_contacts:"Aus Kontakten finden",contacts_loading_or_denied:"Kontakte werden geladen oder Berechtigung verweigert.",theme_light:"Hell",theme_dark:"Dunkel",theme_system:"System",
      welcome:"Willkommen",addTask:"Neue Aufgabe hinzufÃ¼gen...",habits:"Gewohnheiten",stats:"Statistiken",settings:"Einstellungen",appearance:"Darstellung",language:"Sprache",logout:"Abmelden",assign_to:"Zuweisen an",description:"Beschreibung",start_date:"Startdatum",due_date:"FÃ¤lligkeitsdatum",daily:"TÃ¤glich",weekly:"WÃ¶chentlich",new_habit:"Neue Gewohnheit",habit_name:"Gewohnheitsname",frequency:"Frequenz",days:"Tage",end_date:"Enddatum",time:"Zeit",create:"Erstellen",cancel:"Abbrechen",save:"Speichern",delete:"LÃ¶schen",edit:"Bearbeiten",completed:"Abgeschlossen",search_contact:"Kontakt suchen...",notification:"Benachrichtigung",alarm:"Alarm",every_day:"Jeden Tag",change_photo:"Foto Ã¤ndern",today: "Heute",all_good: "Alles in Ordnung!",no_tasks_today: "FÃ¼ge einen Plan fÃ¼r heute hinzu.",tasks_tab:"Aufgaben",habits_tab:"Gewohnheiten",messages_tab:"Nachrichten",social_tab:"Sozial",profile_tab:"Profil",},
  es:{categories_title:"CategorÃ­as",category_name_placeholder:"Nombre de la categorÃ­a...",edit_categories:"Editar categorÃ­as",at_least_one_category:"Debe quedar al menos una categorÃ­a.",ok_btn:"OK",warning_label:"Advertencia",delete_label:"Eliminar",title_label:"TÃ­tulo",add_note_placeholder:"Agregar nota...",which_days:"Â¿QuÃ© dÃ­as?",category:"CategorÃ­a",delete_habit_confirm:"Â¿Quieres eliminar este hÃ¡bito?",motivational_daily:"SÃ© un 1% mejor cada dÃ­a.",connections:"Conexiones",close:"Cerrar",me:"Yo",work:"Trabajo",personal:"Personal",home:"Hogar",habit_name_label:"Nombre del hÃ¡bito",time_placeholder:"Hora (09:00)",every_day_label:"Cada dÃ­a",weekly_label:"Semanal",day_label:"DÃ­a",start_habit:"Iniciar hÃ¡bito",no_connections:"AÃºn no tienes conexiones.",friends:"Amigos",no_users:"AÃºn no hay usuarios.",search_username:"Buscar nombre de usuario...",find_from_contacts:"Buscar desde contactos",contacts_loading_or_denied:"Cargando contactos o permiso denegado.",theme_light:"Claro",theme_dark:"Oscuro",theme_system:"Sistema",
      welcome:"Bienvenido",addTask:"Agregar una nueva tarea...",habits:"HÃ¡bitos",stats:"EstadÃ­sticas",settings:"ConfiguraciÃ³n",appearance:"Apariencia",language:"Idioma",logout:"Cerrar sesiÃ³n",assign_to:"Asignar a",description:"DescripciÃ³n",start_date:"Fecha de inicio",due_date:"Fecha lÃ­mite",daily:"Diario",weekly:"Semanal",new_habit:"Nuevo hÃ¡bito",habit_name:"Nombre del hÃ¡bito",frequency:"Frecuencia",days:"DÃ­as",end_date:"Fecha de finalizaciÃ³n",time:"Hora",create:"Crear",cancel:"Cancelar",save:"Guardar",delete:"Eliminar",edit:"Editar",completed:"Completado",search_contact:"Buscar contacto...",notification:"NotificaciÃ³n",alarm:"Alarma",every_day:"Cada dÃ­a",change_photo:"Cambiar foto",today: "Hoy",all_good: "Â¡Todo en orden!",no_tasks_today: "Agrega un plan para hoy.",tasks_tab:"Tareas",habits_tab:"HÃ¡bitos",messages_tab:"Mensajes",social_tab:"Social",profile_tab:"Perfil",},
  fr:{categories_title:"CatÃ©gories",category_name_placeholder:"Nom de la catÃ©gorie...",edit_categories:"Modifier les catÃ©gories",at_least_one_category:"Au moins une catÃ©gorie doit rester.",ok_btn:"OK",warning_label:"Avertissement",delete_label:"Supprimer",title_label:"Titre",add_note_placeholder:"Ajouter une note...",which_days:"Quels jours ?",category:"CatÃ©gorie",delete_habit_confirm:"Voulez-vous supprimer cette habitude ?",motivational_daily:"Devenez 1% meilleur chaque jour.",connections:"Connexions",close:"Fermer",me:"Moi",work:"Travail",personal:"Personnel",home:"Maison",habit_name_label:"Nom de l'habitude",time_placeholder:"Heure (09:00)",every_day_label:"Chaque jour",weekly_label:"Hebdomadaire",day_label:"Jour",start_habit:"Commencer l'habitude",no_connections:"Vous nâ€™avez encore aucune connexion.",friends:"Amis",no_users:"Aucun utilisateur pour le moment.",search_username:"Rechercher un nom dâ€™utilisateur...",find_from_contacts:"Trouver dans les contacts",contacts_loading_or_denied:"Chargement des contacts ou permission refusÃ©e.",theme_light:"Clair",theme_dark:"Sombre",theme_system:"SystÃ¨me",
      welcome:"Bienvenue",addTask:"Ajouter une nouvelle tÃ¢che...",habits:"Habitudes",stats:"Statistiques",settings:"ParamÃ¨tres",appearance:"Apparence",language:"Langue",logout:"Se dÃ©connecter",assign_to:"Assigner Ã ",description:"Description",start_date:"Date de dÃ©but",due_date:"Date limite",daily:"Quotidien",weekly:"Hebdomadaire",new_habit:"Nouvelle habitude",habit_name:"Nom de l'habitude",frequency:"FrÃ©quence",days:"Jours",end_date:"Date de fin",time:"Heure",create:"CrÃ©er",cancel:"Annuler",save:"Enregistrer",delete:"Supprimer",edit:"Modifier",completed:"TerminÃ©",search_contact:"Rechercher un contact...",notification:"Notification",alarm:"Alarme",every_day:"Chaque jour",change_photo:"Changer la photo",today: "Aujourdâ€™hui",all_good: "Tout va bien !",no_tasks_today: "Ajoutez un plan pour aujourdâ€™hui.",tasks_tab:"TÃ¢ches",habits_tab:"Habitudes",messages_tab:"Messages",social_tab:"Social",profile_tab:"Profil",},
  ar:{categories_title:"Ø§Ù„ÙØ¦Ø§Øª",category_name_placeholder:"Ø§Ø³Ù… Ø§Ù„ÙØ¦Ø©...",edit_categories:"ØªØ­Ø±ÙŠØ± Ø§Ù„ÙØ¦Ø§Øª",at_least_one_category:"ÙŠØ¬Ø¨ Ø£Ù† ØªØ¨Ù‚Ù‰ ÙØ¦Ø© ÙˆØ§Ø­Ø¯Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„.",ok_btn:"Ø­Ø³Ù†Ø§Ù‹",warning_label:"ØªØ­Ø°ÙŠØ±",delete_label:"Ø­Ø°Ù",title_label:"Ø§Ù„Ø¹Ù†ÙˆØ§Ù†",add_note_placeholder:"Ø£Ø¶Ù Ù…Ù„Ø§Ø­Ø¸Ø©...",which_days:"Ù…Ø§ Ù‡ÙŠ Ø§Ù„Ø£ÙŠØ§Ù…ØŸ",category:"Ø§Ù„ÙØ¦Ø©",delete_habit_confirm:"Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ù‡Ø°Ù‡ Ø§Ù„Ø¹Ø§Ø¯Ø©ØŸ",motivational_daily:"ÙƒÙ† Ø£ÙØ¶Ù„ Ø¨Ù†Ø³Ø¨Ø© 1Ùª ÙƒÙ„ ÙŠÙˆÙ….",connections:"Ø§Ù„Ø§ØªØµØ§Ù„Ø§Øª",close:"Ø¥ØºÙ„Ø§Ù‚",me:"Ø£Ù†Ø§",work:"Ø¹Ù…Ù„",personal:"Ø´Ø®ØµÙŠ",home:"Ø§Ù„Ù…Ù†Ø²Ù„",habit_name_label:"Ø§Ø³Ù… Ø§Ù„Ø¹Ø§Ø¯Ø©",time_placeholder:"Ø§Ù„ÙˆÙ‚Øª (09:00)",every_day_label:"ÙƒÙ„ ÙŠÙˆÙ…",weekly_label:"Ø£Ø³Ø¨ÙˆØ¹ÙŠ",day_label:"ÙŠÙˆÙ…",start_habit:"Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø¹Ø§Ø¯Ø©",no_connections:"Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ Ø£ÙŠ Ø§ØªØµØ§Ù„ Ø¨Ø¹Ø¯.",friends:"Ø§Ù„Ø£ØµØ¯Ù‚Ø§Ø¡",no_users:"Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø³ØªØ®Ø¯Ù…ÙˆÙ† Ø¨Ø¹Ø¯.",search_username:"Ø§Ø¨Ø­Ø« Ø¹Ù† Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…...",find_from_contacts:"Ø§Ù„Ø¨Ø­Ø« Ù…Ù† Ø¬Ù‡Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„",contacts_loading_or_denied:"Ø¬Ø§Ø±Ù ØªØ­Ù…ÙŠÙ„ Ø¬Ù‡Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„ Ø£Ùˆ ØªÙ… Ø±ÙØ¶ Ø§Ù„Ø¥Ø°Ù†.",theme_light:"ÙØ§ØªØ­",theme_dark:"Ø¯Ø§ÙƒÙ†",theme_system:"Ø§Ù„Ù†Ø¸Ø§Ù…",
      welcome:"Ù…Ø±Ø­Ø¨Ø§",addTask:"Ø£Ø¶Ù Ù…Ù‡Ù…Ø© Ø¬Ø¯ÙŠØ¯Ø©...",habits:"Ø§Ù„Ø¹Ø§Ø¯Ø§Øª",stats:"Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª",settings:"Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª",appearance:"Ø§Ù„Ù…Ø¸Ù‡Ø±",language:"Ø§Ù„Ù„ØºØ©",logout:"ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬",assign_to:"ØªØ¹ÙŠÙŠÙ† Ø¥Ù„Ù‰",description:"Ø§Ù„ÙˆØµÙ",start_date:"ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¨Ø¯Ø¡",due_date:"ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡",daily:"ÙŠÙˆÙ…ÙŠ",weekly:"Ø£Ø³Ø¨ÙˆØ¹ÙŠ",new_habit:"Ø¹Ø§Ø¯Ø© Ø¬Ø¯ÙŠØ¯Ø©",habit_name:"Ø§Ø³Ù… Ø§Ù„Ø¹Ø§Ø¯Ø©",frequency:"Ø§Ù„ØªÙƒØ±Ø§Ø±",days:"Ø§Ù„Ø£ÙŠØ§Ù…",end_date:"ØªØ§Ø±ÙŠØ® Ø§Ù„Ù†Ù‡Ø§ÙŠØ©",time:"Ø§Ù„ÙˆÙ‚Øª",create:"Ø¥Ù†Ø´Ø§Ø¡",cancel:"Ø¥Ù„ØºØ§Ø¡",save:"Ø­ÙØ¸",delete:"Ø­Ø°Ù",edit:"ØªØ¹Ø¯ÙŠÙ„",completed:"Ù…ÙƒØªÙ…Ù„",search_contact:"Ø§Ø¨Ø­Ø« Ø¹Ù† Ø¬Ù‡Ø© Ø§ØªØµØ§Ù„...",notification:"Ø¥Ø´Ø¹Ø§Ø±",alarm:"Ù…Ù†Ø¨Ù‡",every_day:"ÙƒÙ„ ÙŠÙˆÙ…",change_photo:"ØªØºÙŠÙŠØ± Ø§Ù„ØµÙˆØ±Ø©",today: "Ø§Ù„ÙŠÙˆÙ…",all_good: "ÙƒÙ„ Ø´ÙŠØ¡ Ø¹Ù„Ù‰ Ù…Ø§ ÙŠØ±Ø§Ù…!",no_tasks_today: "Ø£Ø¶Ù Ø®Ø·Ø© Ù„Ù„ÙŠÙˆÙ….",tasks_tab:"Ø§Ù„Ù…Ù‡Ø§Ù…",habits_tab:"Ø§Ù„Ø¹Ø§Ø¯Ø§Øª",messages_tab:"Ø§Ù„Ø±Ø³Ø§Ø¦Ù„",social_tab:"Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠ",profile_tab:"Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ",},
  id:{categories_title:"Kategori",category_name_placeholder:"Nama kategori...",edit_categories:"Edit kategori",at_least_one_category:"Setidaknya satu kategori harus tersisa.",ok_btn:"OK",warning_label:"Peringatan",delete_label:"Hapus",title_label:"Judul",add_note_placeholder:"Tambahkan catatan...",which_days:"Hari apa saja?",category:"Kategori",delete_habit_confirm:"Apakah Anda ingin menghapus kebiasaan ini?",motivational_daily:"Jadilah 1% lebih baik setiap hari.",connections:"Koneksi",close:"Tutup",me:"Saya",work:"Pekerjaan",personal:"Pribadi",home:"Rumah",habit_name_label:"Nama kebiasaan",time_placeholder:"Waktu (09:00)",every_day_label:"Setiap hari",weekly_label:"Mingguan",day_label:"Hari",start_habit:"Mulai kebiasaan",no_connections:"Kamu belum punya koneksi.",friends:"Teman",no_users:"Belum ada pengguna.",search_username:"Cari nama pengguna...",find_from_contacts:"Cari dari kontak",contacts_loading_or_denied:"Memuat kontak atau izin ditolak.",theme_light:"Terang",theme_dark:"Gelap",theme_system:"Sistem",
      welcome:"Selamat datang",addTask:"Tambahkan tugas baru...",habits:"Kebiasaan",stats:"Statistik",settings:"Pengaturan",appearance:"Tampilan",language:"Bahasa",logout:"Keluar",assign_to:"Tugaskan kepada",description:"Deskripsi",start_date:"Tanggal mulai",due_date:"Tanggal jatuh tempo",daily:"Harian",weekly:"Mingguan",new_habit:"Kebiasaan baru",habit_name:"Nama kebiasaan",frequency:"Frekuensi",days:"Hari",end_date:"Tanggal berakhir",time:"Waktu",create:"Buat",cancel:"Batal",save:"Simpan",delete:"Hapus",edit:"Edit",completed:"Selesai",search_contact:"Cari kontak...",notification:"Notifikasi",alarm:"Alarm",every_day:"Setiap hari",change_photo:"Ganti foto",today: "Hari ini",all_good: "Semua baik-baik saja!",no_tasks_today: "Tambahkan rencana untuk hari ini.",tasks_tab:"Tugas",habits_tab:"Kebiasaan",messages_tab:"Pesan",social_tab:"Sosial",profile_tab:"Profil",},
  pt:{categories_title:"Categorias",category_name_placeholder:"Nome da categoria...",edit_categories:"Editar categorias",at_least_one_category:"Pelo menos uma categoria deve permanecer.",ok_btn:"OK",warning_label:"Aviso",delete_label:"Excluir",title_label:"TÃ­tulo",add_note_placeholder:"Adicionar nota...",which_days:"Quais dias?",category:"Categoria",delete_habit_confirm:"Deseja excluir este hÃ¡bito?",motivational_daily:"Seja 1% melhor a cada dia.",connections:"ConexÃµes",close:"Fechar",me:"Eu",work:"Trabalho",personal:"Pessoal",home:"Casa",habit_name_label:"Nome do hÃ¡bito",time_placeholder:"Hora (09:00)",every_day_label:"Todos os dias",weekly_label:"Semanal",day_label:"Dia",start_habit:"Iniciar hÃ¡bito",no_connections:"VocÃª ainda nÃ£o tem conexÃµes.",friends:"Amigos",no_users:"Ainda nÃ£o hÃ¡ usuÃ¡rios.",search_username:"Buscar nome de usuÃ¡rio...",find_from_contacts:"Encontrar nos contatos",contacts_loading_or_denied:"Carregando contatos ou permissÃ£o negada.",theme_light:"Claro",theme_dark:"Escuro",theme_system:"Sistema",
      welcome:"Bem-vindo",addTask:"Adicionar nova tarefa...",habits:"HÃ¡bitos",stats:"EstatÃ­sticas",settings:"ConfiguraÃ§Ãµes",appearance:"AparÃªncia",language:"Idioma",logout:"Sair",assign_to:"Atribuir a",description:"DescriÃ§Ã£o",start_date:"Data de inÃ­cio",due_date:"Data de vencimento",daily:"DiÃ¡rio",weekly:"Semanal",new_habit:"Novo hÃ¡bito",habit_name:"Nome do hÃ¡bito",frequency:"FrequÃªncia",days:"Dias",end_date:"Data final",time:"Hora",create:"Criar",cancel:"Cancelar",save:"Salvar",delete:"Excluir",edit:"Editar",completed:"ConcluÃ­do",search_contact:"Pesquisar contato...",notification:"NotificaÃ§Ã£o",alarm:"Alarme",every_day:"Todos os dias",change_photo:"Alterar foto",today: "Hoje",all_good: "Tudo certo!",no_tasks_today: "Adicione um plano para hoje.",tasks_tab:"Tarefas",habits_tab:"HÃ¡bitos",messages_tab:"Mensagens",social_tab:"Social",profile_tab:"Perfil",},
  hi:{categories_title:"à¤¶à¥à¤°à¥‡à¤£à¤¿à¤¯à¤¾à¤",category_name_placeholder:"à¤¶à¥à¤°à¥‡à¤£à¥€ à¤•à¤¾ à¤¨à¤¾à¤®...",edit_categories:"à¤¶à¥à¤°à¥‡à¤£à¤¿à¤¯à¤¾à¤ à¤¸à¤‚à¤ªà¤¾à¤¦à¤¿à¤¤ à¤•à¤°à¥‡à¤‚",at_least_one_category:"à¤•à¤® à¤¸à¥‡ à¤•à¤® à¤à¤• à¤¶à¥à¤°à¥‡à¤£à¥€ à¤°à¤¹à¤¨à¥€ à¤šà¤¾à¤¹à¤¿à¤.",ok_btn:"à¤ à¥€à¤• à¤¹à¥ˆ",warning_label:"à¤šà¥‡à¤¤à¤¾à¤µà¤¨à¥€",delete_label:"à¤¹à¤Ÿà¤¾à¤à¤",title_label:"à¤¶à¥€à¤°à¥à¤·à¤•",add_note_placeholder:"à¤¨à¥‹à¤Ÿ à¤œà¥‹à¤¡à¤¼à¥‡à¤‚...",which_days:"à¤•à¥Œà¤¨ à¤¸à¥‡ à¤¦à¤¿à¤¨?",category:"à¤¶à¥à¤°à¥‡à¤£à¥€",delete_habit_confirm:"à¤•à¥à¤¯à¤¾ à¤†à¤ª à¤‡à¤¸ à¤†à¤¦à¤¤ à¤•à¥‹ à¤¹à¤Ÿà¤¾à¤¨à¤¾ à¤šà¤¾à¤¹à¤¤à¥‡ à¤¹à¥ˆà¤‚?",motivational_daily:"à¤¹à¤° à¤¦à¤¿à¤¨ 1% à¤¬à¥‡à¤¹à¤¤à¤° à¤¬à¤¨à¥‡à¤‚à¥¤",connections:"à¤•à¤¨à¥‡à¤•à¥à¤¶à¤¨",close:"à¤¬à¤‚à¤¦ à¤•à¤°à¥‡à¤‚",me:"à¤®à¥ˆà¤‚",work:"à¤•à¤¾à¤®",personal:"à¤µà¥à¤¯à¤•à¥à¤¤à¤¿à¤—à¤¤",home:"à¤˜à¤°",habit_name_label:"à¤†à¤¦à¤¤ à¤•à¤¾ à¤¨à¤¾à¤®",time_placeholder:"à¤¸à¤®à¤¯ (09:00)",every_day_label:"à¤¹à¤° à¤¦à¤¿à¤¨",weekly_label:"à¤¸à¤¾à¤ªà¥à¤¤à¤¾à¤¹à¤¿à¤•",day_label:"à¤¦à¤¿à¤¨",start_habit:"à¤†à¤¦à¤¤ à¤¶à¥à¤°à¥‚ à¤•à¤°à¥‡à¤‚",no_connections:"à¤†à¤ªà¤•à¥€ à¤…à¤­à¥€ à¤¤à¤• à¤•à¤¿à¤¸à¥€ à¤¸à¥‡ à¤•à¤¨à¥‡à¤•à¥à¤¶à¤¨ à¤¨à¤¹à¥€à¤‚ à¤¹à¥ˆ.",friends:"à¤¦à¥‹à¤¸à¥à¤¤",no_users:"à¤…à¤­à¥€ à¤•à¥‹à¤ˆ à¤‰à¤ªà¤¯à¥‹à¤—à¤•à¤°à¥à¤¤à¤¾ à¤¨à¤¹à¥€à¤‚.",search_username:"à¤‰à¤ªà¤¯à¥‹à¤—à¤•à¤°à¥à¤¤à¤¾ à¤¨à¤¾à¤® à¤–à¥‹à¤œà¥‡à¤‚...",find_from_contacts:"à¤¸à¤‚à¤ªà¤°à¥à¤•à¥‹à¤‚ à¤¸à¥‡ à¤–à¥‹à¤œà¥‡à¤‚",contacts_loading_or_denied:"à¤¸à¤‚à¤ªà¤°à¥à¤• à¤²à¥‹à¤¡ à¤¹à¥‹ à¤°à¤¹à¥‡ à¤¹à¥ˆà¤‚ à¤¯à¤¾ à¤…à¤¨à¥à¤®à¤¤à¤¿ à¤…à¤¸à¥à¤µà¥€à¤•à¥ƒà¤¤.",theme_light:"à¤¹à¤²à¥à¤•à¤¾",theme_dark:"à¤—à¤¹à¤°à¤¾",theme_system:"à¤¸à¤¿à¤¸à¥à¤Ÿà¤®",
      welcome:"à¤¸à¥à¤µà¤¾à¤—à¤¤ à¤¹à¥ˆ",addTask:"à¤à¤• à¤¨à¤¯à¤¾ à¤•à¤¾à¤°à¥à¤¯ à¤œà¥‹à¤¡à¤¼à¥‡à¤‚...",habits:"à¤†à¤¦à¤¤à¥‡à¤‚",stats:"à¤†à¤à¤•à¤¡à¤¼à¥‡",settings:"à¤¸à¥‡à¤Ÿà¤¿à¤‚à¤—à¥à¤¸",appearance:"à¤¦à¤¿à¤–à¤¾à¤µà¤Ÿ",language:"à¤­à¤¾à¤·à¤¾",logout:"à¤²à¥‰à¤— à¤†à¤‰à¤Ÿ",assign_to:"à¤¸à¥Œà¤‚à¤ªà¥‡à¤‚",description:"à¤µà¤¿à¤µà¤°à¤£",start_date:"à¤ªà¥à¤°à¤¾à¤°à¤‚à¤­ à¤¤à¤¿à¤¥à¤¿",due_date:"à¤¨à¤¿à¤¯à¤¤ à¤¤à¤¿à¤¥à¤¿",daily:"à¤¦à¥ˆà¤¨à¤¿à¤•",weekly:"à¤¸à¤¾à¤ªà¥à¤¤à¤¾à¤¹à¤¿à¤•",new_habit:"à¤¨à¤ˆ à¤†à¤¦à¤¤",habit_name:"à¤†à¤¦à¤¤ à¤•à¤¾ à¤¨à¤¾à¤®",frequency:"à¤†à¤µà¥ƒà¤¤à¥à¤¤à¤¿",days:"à¤¦à¤¿à¤¨",end_date:"à¤¸à¤®à¤¾à¤ªà¥à¤¤à¤¿ à¤¤à¤¿à¤¥à¤¿",time:"à¤¸à¤®à¤¯",create:"à¤¬à¤¨à¤¾à¤à¤",cancel:"à¤°à¤¦à¥à¤¦",save:"à¤¸à¤¹à¥‡à¤œà¥‡à¤‚",delete:"à¤¹à¤Ÿà¤¾à¤à¤",edit:"à¤¸à¤‚à¤ªà¤¾à¤¦à¤¿à¤¤ à¤•à¤°à¥‡à¤‚",completed:"à¤ªà¥‚à¤°à¥à¤£",search_contact:"à¤¸à¤‚à¤ªà¤°à¥à¤• à¤–à¥‹à¤œà¥‡à¤‚...",notification:"à¤¸à¥‚à¤šà¤¨à¤¾",alarm:"à¤…à¤²à¤¾à¤°à¥à¤®",every_day:"à¤¹à¤° à¤¦à¤¿à¤¨",change_photo:"à¤«à¤¼à¥‹à¤Ÿà¥‹ à¤¬à¤¦à¤²à¥‡à¤‚",today: "à¤†à¤œ",all_good: "à¤¸à¤¬ à¤ à¥€à¤• à¤¹à¥ˆ!",no_tasks_today: "à¤†à¤œ à¤•à¥‡ à¤²à¤¿à¤ à¤à¤• à¤¯à¥‹à¤œà¤¨à¤¾ à¤œà¥‹à¤¡à¤¼à¥‡à¤‚à¥¤",tasks_tab:"à¤•à¤¾à¤°à¥à¤¯",habits_tab:"à¤†à¤¦à¤¤à¥‡à¤‚",messages_tab:"à¤¸à¤‚à¤¦à¥‡à¤¶",social_tab:"à¤¸à¤¾à¤®à¤¾à¤œà¤¿à¤•",profile_tab:"à¤ªà¥à¤°à¥‹à¤«à¤¼à¤¾à¤‡à¤²",},
  ko:{categories_title:"ì¹´í…Œê³ ë¦¬",category_name_placeholder:"ì¹´í…Œê³ ë¦¬ ì´ë¦„...",edit_categories:"ì¹´í…Œê³ ë¦¬ íŽ¸ì§‘",at_least_one_category:"í•˜ë‚˜ ì´ìƒì˜ ì¹´í…Œê³ ë¦¬ê°€ ë‚¨ì•„ ìžˆì–´ì•¼ í•©ë‹ˆë‹¤.",ok_btn:"í™•ì¸",warning_label:"ê²½ê³ ",delete_label:"ì‚­ì œ",title_label:"ì œëª©",add_note_placeholder:"ë©”ëª¨ ì¶”ê°€...",which_days:"ì–´ë–¤ ìš”ì¼?",category:"ì¹´í…Œê³ ë¦¬",delete_habit_confirm:"ì´ ìŠµê´€ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?",motivational_daily:"ë§¤ì¼ 1% ë” ë‚˜ì•„ì§€ì„¸ìš”.",connections:"ì—°ê²°",close:"ë‹«ê¸°",me:"ë‚˜",work:"ì¼",personal:"ê°œì¸",home:"ì§‘",habit_name_label:"ìŠµê´€ ì´ë¦„",time_placeholder:"ì‹œê°„ (09:00)",every_day_label:"ë§¤ì¼",weekly_label:"ë§¤ì£¼",day_label:"ë‚ ",start_habit:"ìŠµê´€ ì‹œìž‘",no_connections:"ì•„ì§ ì—°ê²°ëœ ì‚¬ëžŒì´ ì—†ìŠµë‹ˆë‹¤.",friends:"ì¹œêµ¬",no_users:"ì•„ì§ ì‚¬ìš©ìžê°€ ì—†ìŠµë‹ˆë‹¤.",search_username:"ì‚¬ìš©ìž ì´ë¦„ ê²€ìƒ‰...",find_from_contacts:"ì—°ë½ì²˜ì—ì„œ ì°¾ê¸°",contacts_loading_or_denied:"ì—°ë½ì²˜ ë¡œë”© ì¤‘ ë˜ëŠ” ê¶Œí•œ ê±°ë¶€ë¨.",theme_light:"ë¼ì´íŠ¸",theme_dark:"ë‹¤í¬",theme_system:"ì‹œìŠ¤í…œ",
      welcome:"í™˜ì˜í•©ë‹ˆë‹¤",addTask:"ìƒˆ ìž‘ì—… ì¶”ê°€...",habits:"ìŠµê´€",stats:"í†µê³„",settings:"ì„¤ì •",appearance:"ëª¨ì–‘",language:"ì–¸ì–´",logout:"ë¡œê·¸ì•„ì›ƒ",assign_to:"í• ë‹¹ ëŒ€ìƒ",description:"ì„¤ëª…",start_date:"ì‹œìž‘ ë‚ ì§œ",due_date:"ë§ˆê°ì¼",daily:"ë§¤ì¼",weekly:"ë§¤ì£¼",new_habit:"ìƒˆë¡œìš´ ìŠµê´€",habit_name:"ìŠµê´€ ì´ë¦„",frequency:"ë¹ˆë„",days:"ì¼",end_date:"ì¢…ë£Œ ë‚ ì§œ",time:"ì‹œê°„",create:"ìƒì„±",cancel:"ì·¨ì†Œ",save:"ì €ìž¥",delete:"ì‚­ì œ",edit:"íŽ¸ì§‘",completed:"ì™„ë£Œë¨",search_contact:"ì—°ë½ì²˜ ê²€ìƒ‰...",notification:"ì•Œë¦¼",alarm:"ì•ŒëžŒ",every_day:"ë§¤ì¼",change_photo:"ì‚¬ì§„ ë³€ê²½",today: "ì˜¤ëŠ˜",all_good: "ëª¨ë“  ê²ƒì´ ê´œì°®ì•„ìš”!",no_tasks_today: "ì˜¤ëŠ˜ ê³„íšì„ ì¶”ê°€í•˜ì„¸ìš”.",tasks_tab:"ìž‘ì—…",habits_tab:"ìŠµê´€",messages_tab:"ë©”ì‹œì§€",social_tab:"ì†Œì…œ",profile_tab:"í”„ë¡œí•„",},
  ja:{categories_title:"ã‚«ãƒ†ã‚´ãƒªãƒ¼",category_name_placeholder:"ã‚«ãƒ†ã‚´ãƒªãƒ¼å...",edit_categories:"ã‚«ãƒ†ã‚´ãƒªãƒ¼ã‚’ç·¨é›†",at_least_one_category:"å°‘ãªãã¨ã‚‚1ã¤ã®ã‚«ãƒ†ã‚´ãƒªãƒ¼ã‚’æ®‹ã™å¿…è¦ãŒã‚ã‚Šã¾ã™.",ok_btn:"OK",warning_label:"è­¦å‘Š",delete_label:"å‰Šé™¤",title_label:"ã‚¿ã‚¤ãƒˆãƒ«",add_note_placeholder:"ãƒ¡ãƒ¢ã‚’è¿½åŠ ...",which_days:"ã©ã®æ—¥ã§ã™ã‹ï¼Ÿ",category:"ã‚«ãƒ†ã‚´ãƒªãƒ¼",delete_habit_confirm:"ã“ã®ç¿’æ…£ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ",motivational_daily:"æ¯Žæ—¥1%æˆé•·ã—ã‚ˆã†ã€‚",connections:"ã¤ãªãŒã‚Š",close:"é–‰ã˜ã‚‹",me:"ç§",work:"ä»•äº‹",personal:"å€‹äºº",home:"å®¶",habit_name_label:"ç¿’æ…£å",time_placeholder:"æ™‚é–“ (09:00)",every_day_label:"æ¯Žæ—¥",weekly_label:"æ¯Žé€±",day_label:"æ—¥",start_habit:"ç¿’æ…£ã‚’å§‹ã‚ã‚‹",no_connections:"ã¾ã èª°ã¨ã‚‚ã¤ãªãŒã£ã¦ã„ã¾ã›ã‚“ã€‚",friends:"å‹ã ã¡",no_users:"ã¾ã ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã„ã¾ã›ã‚“ã€‚",search_username:"ãƒ¦ãƒ¼ã‚¶ãƒ¼åã‚’æ¤œç´¢...",find_from_contacts:"é€£çµ¡å…ˆã‹ã‚‰æŽ¢ã™",contacts_loading_or_denied:"é€£çµ¡å…ˆã‚’èª­ã¿è¾¼ã¿ä¸­ã¾ãŸã¯è¨±å¯ãŒæ‹’å¦ã•ã‚Œã¾ã—ãŸã€‚",theme_light:"ãƒ©ã‚¤ãƒˆ",theme_dark:"ãƒ€ãƒ¼ã‚¯",theme_system:"ã‚·ã‚¹ãƒ†ãƒ ",
      welcome:"ã‚ˆã†ã“ã",addTask:"æ–°ã—ã„ã‚¿ã‚¹ã‚¯ã‚’è¿½åŠ ...",habits:"ç¿’æ…£",stats:"çµ±è¨ˆ",settings:"è¨­å®š",appearance:"å¤–è¦³",language:"è¨€èªž",logout:"ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ",assign_to:"å‰²ã‚Šå½“ã¦å…ˆ",description:"èª¬æ˜Ž",start_date:"é–‹å§‹æ—¥",due_date:"æœŸé™æ—¥",daily:"æ¯Žæ—¥",weekly:"æ¯Žé€±",new_habit:"æ–°ã—ã„ç¿’æ…£",habit_name:"ç¿’æ…£å",frequency:"é »åº¦",days:"æ—¥",end_date:"çµ‚äº†æ—¥",time:"æ™‚é–“",create:"ä½œæˆ",cancel:"ã‚­ãƒ£ãƒ³ã‚»ãƒ«",save:"ä¿å­˜",delete:"å‰Šé™¤",edit:"ç·¨é›†",completed:"å®Œäº†",search_contact:"é€£çµ¡å…ˆæ¤œç´¢...",notification:"é€šçŸ¥",alarm:"ã‚¢ãƒ©ãƒ¼ãƒ ",every_day:"æ¯Žæ—¥",change_photo:"å†™çœŸã‚’å¤‰æ›´",today: "ä»Šæ—¥",all_good: "ã™ã¹ã¦é †èª¿ã§ã™ï¼",no_tasks_today: "ä»Šæ—¥ã®äºˆå®šã‚’è¿½åŠ ã—ã¦ãã ã•ã„ã€‚",tasks_tab:"ã‚¿ã‚¹ã‚¯",habits_tab:"ç¿’æ…£",messages_tab:"ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸",social_tab:"ã‚½ãƒ¼ã‚·ãƒ£ãƒ«",profile_tab:"ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«",},
  ru:{categories_title:"ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸",category_name_placeholder:"ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸...",edit_categories:"Ð ÐµÐ´Ð°ÐºÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸",at_least_one_category:"Ð”Ð¾Ð»Ð¶Ð½Ð° Ð¾ÑÑ‚Ð°Ñ‚ÑŒÑÑ Ñ…Ð¾Ñ‚Ñ Ð±Ñ‹ Ð¾Ð´Ð½Ð° ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ñ.",ok_btn:"OK",warning_label:"ÐŸÑ€ÐµÐ´ÑƒÐ¿Ñ€ÐµÐ¶Ð´ÐµÐ½Ð¸Ðµ",delete_label:"Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ",title_label:"Ð—Ð°Ð³Ð¾Ð»Ð¾Ð²Ð¾Ðº",add_note_placeholder:"Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ Ð·Ð°Ð¼ÐµÑ‚ÐºÑƒ...",which_days:"ÐšÐ°ÐºÐ¸Ðµ Ð´Ð½Ð¸?",category:"ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ñ",delete_habit_confirm:"Ð’Ñ‹ Ñ…Ð¾Ñ‚Ð¸Ñ‚Ðµ ÑƒÐ´Ð°Ð»Ð¸Ñ‚ÑŒ ÑÑ‚Ñƒ Ð¿Ñ€Ð¸Ð²Ñ‹Ñ‡ÐºÑƒ?",motivational_daily:"Ð¡Ñ‚Ð°Ð½Ð¾Ð²Ð¸Ñ‚ÐµÑÑŒ Ð»ÑƒÑ‡ÑˆÐµ Ð½Ð° 1% ÐºÐ°Ð¶Ð´Ñ‹Ð¹ Ð´ÐµÐ½ÑŒ.",connections:"Ð¡Ð²ÑÐ·Ð¸",close:"Ð—Ð°ÐºÑ€Ñ‹Ñ‚ÑŒ",me:"Ð¯",work:"Ð Ð°Ð±Ð¾Ñ‚Ð°",personal:"Ð›Ð¸Ñ‡Ð½Ð¾Ðµ",home:"Ð”Ð¾Ð¼",habit_name_label:"ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ Ð¿Ñ€Ð¸Ð²Ñ‹Ñ‡ÐºÐ¸",time_placeholder:"Ð’Ñ€ÐµÐ¼Ñ (09:00)",every_day_label:"ÐšÐ°Ð¶Ð´Ñ‹Ð¹ Ð´ÐµÐ½ÑŒ",weekly_label:"Ð•Ð¶ÐµÐ½ÐµÐ´ÐµÐ»ÑŒÐ½Ð¾",day_label:"Ð”ÐµÐ½ÑŒ",start_habit:"ÐÐ°Ñ‡Ð°Ñ‚ÑŒ Ð¿Ñ€Ð¸Ð²Ñ‹Ñ‡ÐºÑƒ",no_connections:"Ð£ Ð²Ð°Ñ Ð¿Ð¾ÐºÐ° Ð½ÐµÑ‚ ÑÐ¾ÐµÐ´Ð¸Ð½ÐµÐ½Ð¸Ð¹.",friends:"Ð”Ñ€ÑƒÐ·ÑŒÑ",no_users:"ÐŸÐ¾ÐºÐ° Ð½ÐµÑ‚ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÐµÐ¹.",search_username:"ÐŸÐ¾Ð¸ÑÐº Ð¸Ð¼ÐµÐ½Ð¸ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ...",find_from_contacts:"ÐÐ°Ð¹Ñ‚Ð¸ Ð² ÐºÐ¾Ð½Ñ‚Ð°ÐºÑ‚Ð°Ñ…",contacts_loading_or_denied:"ÐšÐ¾Ð½Ñ‚Ð°ÐºÑ‚Ñ‹ Ð·Ð°Ð³Ñ€ÑƒÐ¶Ð°ÑŽÑ‚ÑÑ Ð¸Ð»Ð¸ Ñ€Ð°Ð·Ñ€ÐµÑˆÐµÐ½Ð¸Ðµ Ð¾Ñ‚ÐºÐ»Ð¾Ð½ÐµÐ½Ð¾.",theme_light:"Ð¡Ð²ÐµÑ‚Ð»Ð°Ñ",theme_dark:"Ð¢Ñ‘Ð¼Ð½Ð°Ñ",theme_system:"Ð¡Ð¸ÑÑ‚ÐµÐ¼Ð°",
      welcome:"Ð”Ð¾Ð±Ñ€Ð¾ Ð¿Ð¾Ð¶Ð°Ð»Ð¾Ð²Ð°Ñ‚ÑŒ",addTask:"Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ Ð½Ð¾Ð²ÑƒÑŽ Ð·Ð°Ð´Ð°Ñ‡Ñƒ...",habits:"ÐŸÑ€Ð¸Ð²Ñ‹Ñ‡ÐºÐ¸",stats:"Ð¡Ñ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸ÐºÐ°",settings:"ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸",appearance:"Ð’Ð½ÐµÑˆÐ½Ð¸Ð¹ Ð²Ð¸Ð´",language:"Ð¯Ð·Ñ‹Ðº",logout:"Ð’Ñ‹Ð¹Ñ‚Ð¸",assign_to:"ÐÐ°Ð·Ð½Ð°Ñ‡Ð¸Ñ‚ÑŒ",description:"ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ",start_date:"Ð”Ð°Ñ‚Ð° Ð½Ð°Ñ‡Ð°Ð»Ð°",due_date:"Ð¡Ñ€Ð¾Ðº",daily:"Ð•Ð¶ÐµÐ´Ð½ÐµÐ²Ð½Ð¾",weekly:"Ð•Ð¶ÐµÐ½ÐµÐ´ÐµÐ»ÑŒÐ½Ð¾",new_habit:"ÐÐ¾Ð²Ð°Ñ Ð¿Ñ€Ð¸Ð²Ñ‹Ñ‡ÐºÐ°",habit_name:"ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ Ð¿Ñ€Ð¸Ð²Ñ‹Ñ‡ÐºÐ¸",frequency:"Ð§Ð°ÑÑ‚Ð¾Ñ‚Ð°",days:"Ð”Ð½Ð¸",end_date:"Ð”Ð°Ñ‚Ð° Ð¾ÐºÐ¾Ð½Ñ‡Ð°Ð½Ð¸Ñ",time:"Ð’Ñ€ÐµÐ¼Ñ",create:"Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ",cancel:"ÐžÑ‚Ð¼ÐµÐ½Ð°",save:"Ð¡Ð¾Ñ…Ñ€Ð°Ð½Ð¸Ñ‚ÑŒ",delete:"Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ",edit:"Ð˜Ð·Ð¼ÐµÐ½Ð¸Ñ‚ÑŒ",completed:"Ð—Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð¾",search_contact:"ÐŸÐ¾Ð¸ÑÐº ÐºÐ¾Ð½Ñ‚Ð°ÐºÑ‚Ð¾Ð²...",notification:"Ð£Ð²ÐµÐ´Ð¾Ð¼Ð»ÐµÐ½Ð¸Ðµ",alarm:"Ð‘ÑƒÐ´Ð¸Ð»ÑŒÐ½Ð¸Ðº",every_day:"ÐšÐ°Ð¶Ð´Ñ‹Ð¹ Ð´ÐµÐ½ÑŒ",change_photo:"Ð˜Ð·Ð¼ÐµÐ½Ð¸Ñ‚ÑŒ Ñ„Ð¾Ñ‚Ð¾",today: "Ð¡ÐµÐ³Ð¾Ð´Ð½Ñ",all_good: "Ð’ÑÑ‘ Ð² Ð¿Ð¾Ñ€ÑÐ´ÐºÐµ!",no_tasks_today: "Ð”Ð¾Ð±Ð°Ð²ÑŒÑ‚Ðµ Ð¿Ð»Ð°Ð½ Ð½Ð° ÑÐµÐ³Ð¾Ð´Ð½Ñ.",tasks_tab:"Ð—Ð°Ð´Ð°Ñ‡Ð¸",habits_tab:"ÐŸÑ€Ð¸Ð²Ñ‹Ñ‡ÐºÐ¸",messages_tab:"Ð¡Ð¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ",social_tab:"Ð¡Ð¾Ñ†Ð¸Ð°Ð»ÑŒÐ½Ð¾Ðµ",profile_tab:"ÐŸÑ€Ð¾Ñ„Ð¸Ð»ÑŒ",},
  it:{categories_title:"Categorie",category_name_placeholder:"Nome categoria...",edit_categories:"Modifica categorie",at_least_one_category:"Deve rimanere almeno una categoria.",ok_btn:"OK",warning_label:"Avviso",delete_label:"Elimina",title_label:"Titolo",add_note_placeholder:"Aggiungi nota...",which_days:"Quali giorni?",category:"Categoria",delete_habit_confirm:"Vuoi eliminare questa abitudine?",motivational_daily:"Migliora dell'1% ogni giorno.",connections:"Connessioni",close:"Chiudi",me:"Io",work:"Lavoro",personal:"Personale",home:"Casa",habit_name_label:"Nome dell'abitudine",time_placeholder:"Ora (09:00)",every_day_label:"Ogni giorno",weekly_label:"Settimanale",day_label:"Giorno",start_habit:"Inizia abitudine",no_connections:"Non hai ancora connessioni.",friends:"Amici",no_users:"Non ci sono ancora utenti.",search_username:"Cerca nome utente...",find_from_contacts:"Trova dai contatti",contacts_loading_or_denied:"Caricamento contatti o permesso negato.",theme_light:"Chiaro",theme_dark:"Scuro",theme_system:"Sistema",
      welcome:"Benvenuto",addTask:"Aggiungi un nuovo compito...",habits:"Abitudini",stats:"Statistiche",settings:"Impostazioni",appearance:"Aspetto",language:"Lingua",logout:"Disconnettersi",assign_to:"Assegna a",description:"Descrizione",start_date:"Data di inizio",due_date:"Data di scadenza",daily:"Quotidiano",weekly:"Settimanale",new_habit:"Nuova abitudine",habit_name:"Nome dell'abitudine",frequency:"Frequenza",days:"Giorni",end_date:"Data di fine",time:"Ora",create:"Crea",cancel:"Annulla",save:"Salva",delete:"Elimina",edit:"Modifica",completed:"Completato",search_contact:"Cerca contatto...",notification:"Notifica",alarm:"Allarme",every_day:"Ogni giorno",change_photo:"Cambia foto",today: "Oggi",all_good: "Tutto bene!",no_tasks_today: "Aggiungi un piano per oggi.",tasks_tab:"Compiti",habits_tab:"Abitudini",messages_tab:"Messaggi",social_tab:"Social",profile_tab:"Profilo",},
  pl:{categories_title:"Kategorie",category_name_placeholder:"Nazwa kategorii...",edit_categories:"Edytuj kategorie",at_least_one_category:"Musi pozostaÄ‡ co najmniej jedna kategoria.",ok_btn:"OK",warning_label:"OstrzeÅ¼enie",delete_label:"UsuÅ„",title_label:"TytuÅ‚",add_note_placeholder:"Dodaj notatkÄ™...",which_days:"KtÃ³re dni?",category:"Kategoria",delete_habit_confirm:"Czy chcesz usunÄ…Ä‡ ten nawyk?",motivational_daily:"BÄ…dÅº o 1% lepszy kaÅ¼dego dnia.",connections:"PoÅ‚Ä…czenia",close:"Zamknij",me:"Ja",work:"Praca",personal:"Osobiste",home:"Dom",habit_name_label:"Nazwa nawyku",time_placeholder:"Godzina (09:00)",every_day_label:"Codziennie",weekly_label:"Co tydzieÅ„",day_label:"DzieÅ„",start_habit:"Rozpocznij nawyk",no_connections:"Nie masz jeszcze Å¼adnych poÅ‚Ä…czeÅ„.",friends:"Przyjaciele",no_users:"Nie ma jeszcze uÅ¼ytkownikÃ³w.",search_username:"Szukaj nazwy uÅ¼ytkownika...",find_from_contacts:"ZnajdÅº w kontaktach",contacts_loading_or_denied:"Åadowanie kontaktÃ³w lub odmowa dostÄ™pu.",theme_light:"Jasny",theme_dark:"Ciemny",theme_system:"System",
      welcome:"Witamy",addTask:"Dodaj nowe zadanie...",habits:"Nawyki",stats:"Statystyki",settings:"Ustawienia",appearance:"WyglÄ…d",language:"JÄ™zyk",logout:"Wyloguj",assign_to:"Przypisz do",description:"Opis",start_date:"Data rozpoczÄ™cia",due_date:"Termin",daily:"Codziennie",weekly:"Co tydzieÅ„",new_habit:"Nowy nawyk",habit_name:"Nazwa nawyku",frequency:"CzÄ™stotliwoÅ›Ä‡",days:"Dni",end_date:"Data zakoÅ„czenia",time:"Czas",create:"UtwÃ³rz",cancel:"Anuluj",save:"Zapisz",delete:"UsuÅ„",edit:"Edytuj",completed:"UkoÅ„czono",search_contact:"Szukaj kontaktu...",notification:"Powiadomienie",alarm:"Alarm",every_day:"Codziennie",change_photo:"ZmieÅ„ zdjÄ™cie",today: "Dzisiaj",all_good: "Wszystko w porzÄ…dku!",no_tasks_today: "Dodaj plan na dziÅ›.",tasks_tab:"Zadania",habits_tab:"Nawyki",messages_tab:"WiadomoÅ›ci",social_tab:"SpoÅ‚ecznoÅ›Ä‡",profile_tab:"Profil",},
  uk:{categories_title:"ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ñ–Ñ—",category_name_placeholder:"ÐÐ°Ð·Ð²Ð° ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ñ–Ñ—...",edit_categories:"Ð ÐµÐ´Ð°Ð³ÑƒÐ²Ð°Ñ‚Ð¸ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ñ–Ñ—",at_least_one_category:"ÐœÐ°Ñ” Ð·Ð°Ð»Ð¸ÑˆÐ¸Ñ‚Ð¸ÑÑ Ñ‰Ð¾Ð½Ð°Ð¹Ð¼ÐµÐ½ÑˆÐµ Ð¾Ð´Ð½Ð° ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ñ–Ñ.",ok_btn:"Ð“Ð°Ñ€Ð°Ð·Ð´",warning_label:"ÐŸÐ¾Ð¿ÐµÑ€ÐµÐ´Ð¶ÐµÐ½Ð½Ñ",delete_label:"Ð’Ð¸Ð´Ð°Ð»Ð¸Ñ‚Ð¸",title_label:"Ð—Ð°Ð³Ð¾Ð»Ð¾Ð²Ð¾Ðº",add_note_placeholder:"Ð”Ð¾Ð´Ð°Ñ‚Ð¸ Ð½Ð¾Ñ‚Ð°Ñ‚ÐºÑƒ...",which_days:"Ð¯ÐºÑ– Ð´Ð½Ñ–?",category:"ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ñ–Ñ",delete_habit_confirm:"Ð’Ð¸ Ñ…Ð¾Ñ‡ÐµÑ‚Ðµ Ð²Ð¸Ð´Ð°Ð»Ð¸Ñ‚Ð¸ Ñ†ÑŽ Ð·Ð²Ð¸Ñ‡ÐºÑƒ?",motivational_daily:"Ð¡Ñ‚Ð°Ð²Ð°Ð¹Ñ‚Ðµ ÐºÑ€Ð°Ñ‰Ð¸Ð¼Ð¸ Ð½Ð° 1% Ñ‰Ð¾Ð´Ð½Ñ.",connections:"Ð—Ð²'ÑÐ·ÐºÐ¸",close:"Ð—Ð°ÐºÑ€Ð¸Ñ‚Ð¸",me:"Ð¯",work:"Ð Ð¾Ð±Ð¾Ñ‚Ð°",personal:"ÐžÑÐ¾Ð±Ð¸ÑÑ‚Ðµ",home:"Ð”Ñ–Ð¼",habit_name_label:"ÐÐ°Ð·Ð²Ð° Ð·Ð²Ð¸Ñ‡ÐºÐ¸",time_placeholder:"Ð§Ð°Ñ (09:00)",every_day_label:"Ð©Ð¾Ð´Ð½Ñ",weekly_label:"Ð©Ð¾Ñ‚Ð¸Ð¶Ð½Ñ",day_label:"Ð”ÐµÐ½ÑŒ",start_habit:"ÐŸÐ¾Ñ‡Ð°Ñ‚Ð¸ Ð·Ð²Ð¸Ñ‡ÐºÑƒ",no_connections:"Ð£ Ð²Ð°Ñ Ñ‰Ðµ Ð½ÐµÐ¼Ð°Ñ” Ð·Ð²â€™ÑÐ·ÐºÑ–Ð².",friends:"Ð”Ñ€ÑƒÐ·Ñ–",no_users:"ÐšÐ¾Ñ€Ð¸ÑÑ‚ÑƒÐ²Ð°Ñ‡Ñ–Ð² Ð¿Ð¾ÐºÐ¸ Ð½ÐµÐ¼Ð°Ñ”.",search_username:"ÐŸÐ¾ÑˆÑƒÐº Ñ–Ð¼ÐµÐ½Ñ– ÐºÐ¾Ñ€Ð¸ÑÑ‚ÑƒÐ²Ð°Ñ‡Ð°...",find_from_contacts:"Ð—Ð½Ð°Ð¹Ñ‚Ð¸ Ñƒ ÐºÐ¾Ð½Ñ‚Ð°ÐºÑ‚Ð°Ñ…",contacts_loading_or_denied:"ÐšÐ¾Ð½Ñ‚Ð°ÐºÑ‚Ð¸ Ð·Ð°Ð²Ð°Ð½Ñ‚Ð°Ð¶ÑƒÑŽÑ‚ÑŒÑÑ Ð°Ð±Ð¾ Ð´Ð¾ÑÑ‚ÑƒÐ¿ Ð·Ð°Ð±Ð¾Ñ€Ð¾Ð½ÐµÐ½Ð¾.",theme_light:"Ð¡Ð²Ñ–Ñ‚Ð»Ð°",theme_dark:"Ð¢ÐµÐ¼Ð½Ð°",theme_system:"Ð¡Ð¸ÑÑ‚ÐµÐ¼Ð°",
      welcome:"Ð›Ð°ÑÐºÐ°Ð²Ð¾ Ð¿Ñ€Ð¾ÑÐ¸Ð¼Ð¾",addTask:"Ð”Ð¾Ð´Ð°Ñ‚Ð¸ Ð½Ð¾Ð²Ðµ Ð·Ð°Ð²Ð´Ð°Ð½Ð½Ñ...",habits:"Ð—Ð²Ð¸Ñ‡ÐºÐ¸",stats:"Ð¡Ñ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸ÐºÐ°",settings:"ÐÐ°Ð»Ð°ÑˆÑ‚ÑƒÐ²Ð°Ð½Ð½Ñ",appearance:"Ð—Ð¾Ð²Ð½Ñ–ÑˆÐ½Ñ–Ð¹ Ð²Ð¸Ð³Ð»ÑÐ´",language:"ÐœÐ¾Ð²Ð°",logout:"Ð’Ð¸Ð¹Ñ‚Ð¸",assign_to:"ÐŸÑ€Ð¸Ð·Ð½Ð°Ñ‡Ð¸Ñ‚Ð¸",description:"ÐžÐ¿Ð¸Ñ",start_date:"Ð”Ð°Ñ‚Ð° Ð¿Ð¾Ñ‡Ð°Ñ‚ÐºÑƒ",due_date:"ÐšÑ–Ð½Ñ†ÐµÐ²Ð¸Ð¹ Ñ‚ÐµÑ€Ð¼Ñ–Ð½",daily:"Ð©Ð¾Ð´Ð½Ñ",weekly:"Ð©Ð¾Ñ‚Ð¸Ð¶Ð½Ñ",new_habit:"ÐÐ¾Ð²Ð° Ð·Ð²Ð¸Ñ‡ÐºÐ°",habit_name:"ÐÐ°Ð·Ð²Ð° Ð·Ð²Ð¸Ñ‡ÐºÐ¸",frequency:"Ð§Ð°ÑÑ‚Ð¾Ñ‚Ð°",days:"Ð”Ð½Ñ–",end_date:"Ð”Ð°Ñ‚Ð° Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð½Ñ",time:"Ð§Ð°Ñ",create:"Ð¡Ñ‚Ð²Ð¾Ñ€Ð¸Ñ‚Ð¸",cancel:"Ð¡ÐºÐ°ÑÑƒÐ²Ð°Ñ‚Ð¸",save:"Ð—Ð±ÐµÑ€ÐµÐ³Ñ‚Ð¸",delete:"Ð’Ð¸Ð´Ð°Ð»Ð¸Ñ‚Ð¸",edit:"Ð ÐµÐ´Ð°Ð³ÑƒÐ²Ð°Ñ‚Ð¸",completed:"Ð—Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð¾",search_contact:"ÐŸÐ¾ÑˆÑƒÐº ÐºÐ¾Ð½Ñ‚Ð°ÐºÑ‚Ñƒ...",notification:"Ð¡Ð¿Ð¾Ð²Ñ–Ñ‰ÐµÐ½Ð½Ñ",alarm:"Ð‘ÑƒÐ´Ð¸Ð»ÑŒÐ½Ð¸Ðº",every_day:"Ð©Ð¾Ð´Ð½Ñ",change_photo:"Ð—Ð¼Ñ–Ð½Ð¸Ñ‚Ð¸ Ñ„Ð¾Ñ‚Ð¾",today: "Ð¡ÑŒÐ¾Ð³Ð¾Ð´Ð½Ñ–",all_good: "Ð’ÑÐµ Ð´Ð¾Ð±Ñ€Ðµ!",no_tasks_today: "Ð”Ð¾Ð´Ð°Ð¹Ñ‚Ðµ Ð¿Ð»Ð°Ð½ Ð½Ð° ÑÑŒÐ¾Ð³Ð¾Ð´Ð½Ñ–.",tasks_tab:"Ð—Ð°Ð²Ð´Ð°Ð½Ð½Ñ",habits_tab:"Ð—Ð²Ð¸Ñ‡ÐºÐ¸",messages_tab:"ÐŸÐ¾Ð²Ñ–Ð´Ð¾Ð¼Ð»ÐµÐ½Ð½Ñ",social_tab:"Ð¡Ð¾Ñ†Ñ–Ð°Ð»ÑŒÐ½Ðµ",profile_tab:"ÐŸÑ€Ð¾Ñ„Ñ–Ð»ÑŒ",}
};

// --- TÄ°P TANIMLAMALARI ---
type ThemeMode = 'light' | 'dark' | 'system';
type LangCode = 'en' | 'tr' | 'nl' | 'de' | 'es' | 'fr' | 'ar' | 'id' | 'pt' | 'hi' | 'ko' | 'ja' | 'ru' | 'it' | 'pl' | 'uk';

interface Task { 
  id: string; text: string; description?: string; completed: boolean; date: string; dueDate?: string; showEveryDayUntilDue?: boolean; categoryId: string; notificationTime?: string | null; alarmTime?: string | null; assignedBy?: string; assignedByName?: string; assignedTo?: string; 
}

interface Habit {
  id: string; title: string; frequency: 'daily' | 'weekly'; selectedDays: number[]; endDate?: string | null; notificationTime?: string | null; notificationIds?: string[]; completedDates: string[]; categoryId: string; createdAt: any;
}

interface Category { id: string; name: string; color: string; }
interface Contact { uid: string; username: string; email: string; phoneNumber?: string; canAssignToMe: boolean; defaultCategoryId?: string; photoURL?: string; }
interface FriendRequest { id: string; fromUid: string; fromUsername: string; fromEmail: string; status: 'pending'; }
interface DeviceContact { id: string; name: string; phoneNumber: string; isAppUser?: boolean; uid?: string; }
interface ChatMessage { id: string; text: string; senderId: string; timestamp: any; read?: boolean; }

const getISODate = (date: Date): string => {
  const year = date.getFullYear();
  const month = String(date.getMonth() + 1).padStart(2, '0');
  const day = String(date.getDate()).padStart(2, '0');
  return `${year}-${month}-${day}`;
};

const formatDateDDMMYYYY = (date: Date): string => {
  const day = String(date.getDate()).padStart(2, '0');
  const month = String(date.getMonth() + 1).padStart(2, '0');
  const year = date.getFullYear();
  return `${day}-${month}-${year}`;
};

const parseDueDate = (dateStr?: string) => {
    if (!dateStr) return Infinity; 
    const parts = dateStr.split('-');
    if (parts.length !== 3) return Infinity;
    return new Date(parseInt(parts[2]), parseInt(parts[1]) - 1, parseInt(parts[0])).getTime();
};

const convertDDMMYYYYtoISO = (dateStr: string) => {
    const parts = dateStr.split('-');
    if (parts.length !== 3) return dateStr;
    return `${parts[2]}-${parts[1]}-${parts[0]}`;
};

const maskDateInput = (text: string) => {
  const cleaned = text.replace(/[^0-9]/g, '');
  let formatted = cleaned;
  if (cleaned.length > 2) formatted = cleaned.slice(0, 2) + '-' + cleaned.slice(2);
  if (cleaned.length > 4) formatted = formatted.slice(0, 5) + '-' + cleaned.slice(4);
  return formatted.slice(0, 10); 
};

const maskTimeInput = (text: string) => {
  const cleaned = text.replace(/[^0-9]/g, '');
  let formatted = cleaned;
  if (cleaned.length > 2) formatted = cleaned.slice(0, 2) + ':' + cleaned.slice(2);
  return formatted.slice(0, 5);
};

const GREETINGS = {
  en:{morning:"Good morning",afternoon:"Good afternoon",evening:"Good evening"},
  tr:{morning:"GÃ¼naydÄ±n",afternoon:"TÃ¼naydÄ±n",evening:"Ä°yi akÅŸamlar"},
  nl:{morning:"Goedemorgen",afternoon:"Goedemiddag",evening:"Goedenavond"},
  de:{morning:"Guten Morgen",afternoon:"Guten Nachmittag",evening:"Guten Abend"},
  es:{morning:"Buenos dÃ­as",afternoon:"Buenas tardes",evening:"Buenas noches"},
  fr:{morning:"Bonjour",afternoon:"Bon aprÃ¨s-midi",evening:"Bonsoir"},
  ar:{morning:"ØµØ¨Ø§Ø­ Ø§Ù„Ø®ÙŠØ±",afternoon:"Ù…Ø³Ø§Ø¡ Ø§Ù„Ø®ÙŠØ±",evening:"Ù…Ø³Ø§Ø¡ Ø§Ù„Ø®ÙŠØ±"},
  id:{morning:"Selamat pagi",afternoon:"Selamat siang",evening:"Selamat malam"},
  pt:{morning:"Bom dia",afternoon:"Boa tarde",evening:"Boa noite"},
  hi:{morning:"à¤¸à¥à¤ªà¥à¤°à¤­à¤¾à¤¤",afternoon:"à¤¨à¤®à¤¸à¥à¤•à¤¾à¤°",evening:"à¤¶à¥à¤­ à¤¸à¤‚à¤§à¥à¤¯à¤¾"},
  ko:{morning:"ì¢‹ì€ ì•„ì¹¨",afternoon:"ì¢‹ì€ ì˜¤í›„",evening:"ì¢‹ì€ ì €ë…"},
  ja:{morning:"ãŠã¯ã‚ˆã†ã”ã–ã„ã¾ã™",afternoon:"ã“ã‚“ã«ã¡ã¯",evening:"ã“ã‚“ã°ã‚“ã¯"},
  ru:{morning:"Ð”Ð¾Ð±Ñ€Ð¾Ðµ ÑƒÑ‚Ñ€Ð¾",afternoon:"Ð”Ð¾Ð±Ñ€Ñ‹Ð¹ Ð´ÐµÐ½ÑŒ",evening:"Ð”Ð¾Ð±Ñ€Ñ‹Ð¹ Ð²ÐµÑ‡ÐµÑ€"},
  it:{morning:"Buongiorno",afternoon:"Buon pomeriggio",evening:"Buonasera"},
  pl:{morning:"DzieÅ„ dobry",afternoon:"DzieÅ„ dobry",evening:"Dobry wieczÃ³r"},
  uk:{morning:"Ð”Ð¾Ð±Ñ€Ð¾Ð³Ð¾ Ñ€Ð°Ð½ÐºÑƒ",afternoon:"Ð”Ð¾Ð±Ñ€Ð¸Ð¹ Ð´ÐµÐ½ÑŒ",evening:"Ð”Ð¾Ð±Ñ€Ð¸Ð¹ Ð²ÐµÑ‡Ñ–Ñ€"}
};
const getGreeting = (lang:LangCode)=>{const hour=new Date().getHours();const g=GREETINGS[lang]||GREETINGS.en;return hour<12?g.morning:hour<18?g.afternoon:g.evening;};


const DAYS_OF_WEEK_MAP = {
  en:[{id:1,label:"Mon"},{id:2,label:"Tue"},{id:3,label:"Wed"},{id:4,label:"Thu"},{id:5,label:"Fri"},{id:6,label:"Sat"},{id:0,label:"Sun"}],
  tr:[{id:1,label:"Pzt"},{id:2,label:"Sal"},{id:3,label:"Ã‡ar"},{id:4,label:"Per"},{id:5,label:"Cum"},{id:6,label:"Cmt"},{id:0,label:"Paz"}],
  nl:[{id:1,label:"Ma"},{id:2,label:"Di"},{id:3,label:"Wo"},{id:4,label:"Do"},{id:5,label:"Vr"},{id:6,label:"Za"},{id:0,label:"Zo"}],
  de:[{id:1,label:"Mo"},{id:2,label:"Di"},{id:3,label:"Mi"},{id:4,label:"Do"},{id:5,label:"Fr"},{id:6,label:"Sa"},{id:0,label:"So"}],
  es:[{id:1,label:"Lun"},{id:2,label:"Mar"},{id:3,label:"MiÃ©"},{id:4,label:"Jue"},{id:5,label:"Vie"},{id:6,label:"SÃ¡b"},{id:0,label:"Dom"}],
  fr:[{id:1,label:"Lun"},{id:2,label:"Mar"},{id:3,label:"Mer"},{id:4,label:"Jeu"},{id:5,label:"Ven"},{id:6,label:"Sam"},{id:0,label:"Dim"}],
  ar:[{id:1,label:"Ø§Ù„Ø§Ø«Ù†ÙŠÙ†"},{id:2,label:"Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡"},{id:3,label:"Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡"},{id:4,label:"Ø§Ù„Ø®Ù…ÙŠØ³"},{id:5,label:"Ø§Ù„Ø¬Ù…Ø¹Ø©"},{id:6,label:"Ø§Ù„Ø³Ø¨Øª"},{id:0,label:"Ø§Ù„Ø£Ø­Ø¯"}],
  id:[{id:1,label:"Sen"},{id:2,label:"Sel"},{id:3,label:"Rab"},{id:4,label:"Kam"},{id:5,label:"Jum"},{id:6,label:"Sab"},{id:0,label:"Min"}],
  pt:[{id:1,label:"Seg"},{id:2,label:"Ter"},{id:3,label:"Qua"},{id:4,label:"Qui"},{id:5,label:"Sex"},{id:6,label:"SÃ¡b"},{id:0,label:"Dom"}],
  hi:[{id:1,label:"à¤¸à¥‹à¤®"},{id:2,label:"à¤®à¤‚à¤—à¤²"},{id:3,label:"à¤¬à¥à¤§"},{id:4,label:"à¤—à¥à¤°à¥"},{id:5,label:"à¤¶à¥à¤•à¥à¤°"},{id:6,label:"à¤¶à¤¨à¤¿"},{id:0,label:"à¤°à¤µà¤¿"}],
  ko:[{id:1,label:"ì›”"},{id:2,label:"í™”"},{id:3,label:"ìˆ˜"},{id:4,label:"ëª©"},{id:5,label:"ê¸ˆ"},{id:6,label:"í† "},{id:0,label:"ì¼"}],
  ja:[{id:1,label:"æœˆ"},{id:2,label:"ç«"},{id:3,label:"æ°´"},{id:4,label:"æœ¨"},{id:5,label:"é‡‘"},{id:6,label:"åœŸ"},{id:0,label:"æ—¥"}],
  ru:[{id:1,label:"ÐŸÐ½"},{id:2,label:"Ð’Ñ‚"},{id:3,label:"Ð¡Ñ€"},{id:4,label:"Ð§Ñ‚"},{id:5,label:"ÐŸÑ‚"},{id:6,label:"Ð¡Ð±"},{id:0,label:"Ð’Ñ"}],
  it:[{id:1,label:"Lun"},{id:2,label:"Mar"},{id:3,label:"Mer"},{id:4,label:"Gio"},{id:5,label:"Ven"},{id:6,label:"Sab"},{id:0,label:"Dom"}],
  pl:[{id:1,label:"Pon"},{id:2,label:"Wto"},{id:3,label:"Åšro"},{id:4,label:"Czw"},{id:5,label:"PiÄ…"},{id:6,label:"Sob"},{id:0,label:"Nie"}],
  uk:[{id:1,label:"ÐŸÐ½"},{id:2,label:"Ð’Ñ‚"},{id:3,label:"Ð¡Ñ€"},{id:4,label:"Ð§Ñ‚"},{id:5,label:"ÐŸÑ‚"},{id:6,label:"Ð¡Ð±"},{id:0,label:"ÐÐ´"}]
};

const getDaysOfWeek = (lang:LangCode)=>DAYS_OF_WEEK_MAP[lang]||DAYS_OF_WEEK_MAP.en;

export default function OmmioApp() {
  const systemScheme = useColorScheme();
  const [user, setUser] = useState<any>(null);
  const [isAuthLoading, setIsAuthLoading] = useState(true);
  const [isCategoryModalOpen, setIsCategoryModalOpen] = useState(false);
  const [authMethod, setAuthMethod] = useState<'email' | 'phone'>('email'); 
  const [authMode, setAuthMode] = useState<'login' | 'signup'>('login');
  const [email, setEmail] = useState('');
  const [password, setPassword] = useState('');
  const [username, setUsername] = useState('');
  const [phoneNumber, setPhoneNumber] = useState(''); 
  const [newCategoryColor, setNewCategoryColor] = useState('blue'); // VarsayÄ±lan renk
  const CATEGORY_PALETTE = ['blue', 'orange', 'green', 'purple','pink']; // SeÃ§enekler
  const [tasks, setTasks] = useState<Task[]>([]);
  const [habits, setHabits] = useState<Habit[]>([]);
  const [contacts, setContacts] = useState<Contact[]>([]);
  const [friendRequests, setFriendRequests] = useState<FriendRequest[]>([]);
  
  // NAVIGATION STATE
  const [activeTab, setActiveTab] = useState<'list' | 'habits' | 'messages' | 'social' | 'profile' | 'chat_room'>('list');
  const [chatTarget, setChatTarget] = useState<Contact | null>(null); 
  const [chatMessages, setChatMessages] = useState<ChatMessage[]>([]);
  const [chatInput, setChatInput] = useState("");


  const [isTyping, setIsTyping] = useState(false); // KarÅŸÄ± taraf yazÄ±yor mu?
  const [lastVisibleMsg, setLastVisibleMsg] = useState<any>(null); // Pagination iÃ§in
  const [loadingMoreMsg, setLoadingMoreMsg] = useState(false);

  const [showOnboarding, setShowOnboarding] = useState(false);
  const [onboardingStep, setOnboardingStep] = useState(0);
  
  const [msgLimit, setMsgLimit] = useState(125); // BaÅŸlangÄ±Ã§ta 125 mesaj gÃ¶ster

  const [theme, setTheme] = useState<ThemeMode>("system");
  const [lang, setLang] = useState<LangCode>("en");
  const [selectedDate, setSelectedDate] = useState<Date>(new Date());
  const [isSettingsOpen, setIsSettingsOpen] = useState<boolean>(false);
  const [isLangModalOpen, setIsLangModalOpen] = useState(false);
  const [isCompletedExpanded, setIsCompletedExpanded] = useState(false);
  const [isOverdueExpanded, setIsOverdueExpanded] = useState(true);
  const [taskViewMode, setTaskViewMode] = useState<'list' | 'category'>('list');

  // ADD MODAL STATE (Eksik olanlar eklendi)
  const [isAddModalOpen, setIsAddModalOpen] = useState(false); 
  const [addMode, setAddMode] = useState<'task' | 'habit'>('task'); 
  
  const [inputValue, setInputValue] = useState("");
  const [inputDesc, setInputDesc] = useState("");
  const [inputDueDate, setInputDueDate] = useState(""); 
  const [inputStartDate, setInputStartDate] = useState(""); 
  const [notifInput, setNotifInput] = useState("");
  const [alarmInput, setAlarmInput] = useState("");
  const [isNotifOn, setIsNotifOn] = useState(false);
  const [isAlarmOn, setIsAlarmOn] = useState(false);
  const [isEveryDayOn, setIsEveryDayOn] = useState(false);
  const [assignTarget, setAssignTarget] = useState<Contact | null>(null);

  const [newHabitTitle, setNewHabitTitle] = useState("");
  const [newHabitFreq, setNewHabitFreq] = useState<'daily' | 'weekly'>('daily');
  const [newHabitDays, setNewHabitDays] = useState<number[]>([]);
  const [newHabitEndDate, setNewHabitEndDate] = useState("");
  const [habitNotifInput, setHabitNotifInput] = useState(""); 
  const [isHabitModalOpen, setIsHabitModalOpen] = useState(false);
  // ... diÄŸer state tanÄ±mlarÄ±
  const [newCategoryName, setNewCategoryName] = useState("");

  const [categories, setCategories] = useState<Category[]>([
      { id: 'work', name: 'Ä°ÅŸ', color: 'blue' }, 
      { id: 'home', name: 'Ev', color: 'orange' },
      { id: 'personal', name: 'KiÅŸisel', color: 'green' }
  ]);
  const [selectedCategory, setSelectedCategory] = useState<Category>(categories[0]);

  const [selectedTask, setSelectedTask] = useState<Task | null>(null);
  const [expandedTaskId, setExpandedTaskId] = useState<string | null>(null);
  const [activeAlarmTask, setActiveAlarmTask] = useState<Task | null>(null);
  const [detailText, setDetailText] = useState("");
  const [detailDesc, setDetailDesc] = useState("");
  const [detailDueDate, setDetailDueDate] = useState("");

  // DATE PICKERS
  const [showDatePicker, setShowDatePicker] = useState(false);
  const [showDetailDatePicker, setShowDetailDatePicker] = useState(false); 
  const [showHabitDatePicker, setShowHabitDatePicker] = useState(false);
  const [datePickerTarget, setDatePickerTarget] = useState<'start' | 'due' | 'habitEnd' | 'detail'>('start');

  const [deviceContacts, setDeviceContacts] = useState<DeviceContact[]>([]); 
  const [assignSearchText, setAssignSearchText] = useState("");
  const [searchUsername, setSearchUsername] = useState("");
  const [isNetworkModalOpen, setIsNetworkModalOpen] = useState(false);
  const [networkTab, setNetworkTab] = useState<'ommio' | 'contacts'>('ommio'); 
  const [isInputExpanded, setIsInputExpanded] = useState(false);

const [request, response, promptAsync] = Google.useIdTokenAuthRequest({
    // Google Cloud Console'dan aldÄ±ÄŸÄ±n ID'leri buraya yaz:
    clientId: '677937409612-ijhg8dbhknb24hs53t9r8gvse397pvrh.apps.googleusercontent.com', 
    iosClientId: '677937409612-sats3t36t7mko7i2lds7m45sc52aofq2.apps.googleusercontent.com', 
    androidClientId: '677937409612-prdicaptu9fn46vmbp4o1c05nrhg2asb.apps.googleusercontent.com', 
  });

  useEffect(() => {
    if (response?.type === 'success') {
      const { id_token } = response.params;
      const credential = GoogleAuthProvider.credential(id_token);
      signInWithCredential(auth, credential);
    }
  }, [response]);
  useEffect(() => {
    const checkFirstLaunch = async () => {
        const hasLaunched = await AsyncStorage.getItem("hasLaunched");
        if (hasLaunched === null) {
            setShowOnboarding(true);
            await AsyncStorage.setItem("hasLaunched", "true");
        }
    };
    checkFirstLaunch();
}, []);
  // --- APPLE LOGIN ---
  const handleAppleLogin = async () => {
    try {
      const credential = await AppleAuthentication.signInAsync({
        requestedScopes: [
          AppleAuthentication.AppleAuthenticationScope.FULL_NAME,
          AppleAuthentication.AppleAuthenticationScope.EMAIL,
        ],
      });
      const { identityToken } = credential;
      if (identityToken) {
        const provider = new OAuthProvider('apple.com');
        const oAuthCredential = provider.credential({ idToken: identityToken });
        await signInWithCredential(auth, oAuthCredential);
      }
    } catch (e: any) {
      if (e.code !== 'ERR_CANCELED') Alert.alert('Hata', 'Apple giriÅŸi baÅŸarÄ±sÄ±z.');
    }
  };

  // --- EFFECT: AUTH & DATA ---
  useEffect(() => { const unsub = onAuthStateChanged(auth, (u) => { setUser(u); setIsAuthLoading(false); }); return unsub; }, []);
  useEffect(() => { setInputStartDate(formatDateDDMMYYYY(selectedDate)); }, [selectedDate]);

  useEffect(() => {
    const loadSettings = async () => {
        try {
            const savedLang = await AsyncStorage.getItem("ommio_lang");
            const savedTheme = await AsyncStorage.getItem("ommio_theme");
            if (savedLang) setLang(savedLang as LangCode);
            if (savedTheme) setTheme(savedTheme as ThemeMode);
        } catch (e) {}
    };
    loadSettings();
  }, []);

  useEffect(() => {
    const saveSettings = async () => {
        try {
            await AsyncStorage.setItem("ommio_lang", lang);
            await AsyncStorage.setItem("ommio_theme", theme);
        } catch (e) {}
    };
    saveSettings();
  }, [lang, theme]);

  useEffect(() => {
    if (!user) return;
    const qTasks = query(collection(db, "users", user.uid, "tasks"));
    const qHabits = query(collection(db, "users", user.uid, "habits"));
    const qContacts = query(collection(db, "users", user.uid, "contacts"));
    const qReqs = query(collection(db, "users", user.uid, "friend_requests"));

    const unsubT = onSnapshot(qTasks, (snap) => setTasks(snap.docs.map(d => ({ id: d.id, ...d.data() } as Task))));
    const unsubH = onSnapshot(qHabits, (snap) => setHabits(snap.docs.map(d => ({ id: d.id, ...d.data() } as Habit))));
    const unsubC = onSnapshot(qContacts, (snap) => setContacts(snap.docs.map(d => d.data() as Contact)));
    const unsubR = onSnapshot(qReqs, (snap) => setFriendRequests(snap.docs.map(d => ({ id: d.id, ...d.data() } as FriendRequest))));

    return () => { unsubT(); unsubH(); unsubC(); unsubR(); };
  }, [user]);

  // --- EFFECT: CHAT ---
 // --- EFFECT: CHAT (GÃœNCELLENDÄ°: Pagination & Okundu Bilgisi) ---
  useEffect(() => {
    if (!user || !chatTarget) return;

    const chatId = [user.uid, chatTarget.uid].sort().join('_');
    
    // YENÄ°LÄ°K 1: 'desc' (azalan) sÄ±ralama yapÄ±yoruz ki en son mesajlar Ã¶nce gelsin.
    // YENÄ°LÄ°K 2: limit(msgLimit) ile dinamik sayÄ± kadar mesaj Ã§ekiyoruz.
    const qMsgs = query(
        collection(db, "chats", chatId, "messages"), 
        orderBy("timestamp", "desc"), 
        limit(msgLimit)
    );
    
    const unsubMsg = onSnapshot(qMsgs, (snap) => {
        const msgs = snap.docs.map(d => ({ id: d.id, ...d.data() } as ChatMessage));
        
        // YENÄ°LÄ°K 3: OKUNDU BÄ°LGÄ°SÄ° Ä°ÅžLEME
        // Mesaj bana ait deÄŸilse (karÅŸÄ±dan gelmiÅŸse) ve okunmamÄ±ÅŸsa, okundu yap.
        msgs.forEach(async (msg) => {
            if (msg.senderId !== user.uid && !msg.read) {
                try {
                   // updateDoc ile veritabanÄ±nda 'read: true' yapÄ±yoruz
                   await updateDoc(doc(db, "chats", chatId, "messages", msg.id), { read: true });
                } catch (e) {
                   console.log("Okundu iÅŸaretlenemedi", e);
                }
            }
        });

        setChatMessages(msgs);
    });

    return () => unsubMsg();
  }, [user, chatTarget, msgLimit]); // msgLimit deÄŸiÅŸince sorgu tekrar Ã§alÄ±ÅŸÄ±r

  useEffect(() => {
    if (Platform.OS === 'android') {
        const todayISO = getISODate(new Date());
        const todaysTasks = tasks.filter(t => t.date === todayISO);
        const comp = todaysTasks.filter(t => t.completed).length;
        try { 
          // @ts-ignore
          requestWidgetUpdate({ 
            widgetName: 'OmmioWidget', 
            // @ts-ignore
            renderWidget: () => widgetTaskHandler({ 
              completedCount: comp, totalCount: todaysTasks.length, 
              topTasks: todaysTasks.slice(0, 3).map(t => ({ text: t.text, completed: t.completed })) 
            }), widgetNotFound: () => { } 
          }); 
        } catch (e) {}
    }
  }, [tasks]);

  const t = (key: string) => {
    // @ts-ignore
    return TRANSLATIONS[lang]?.[key] || TRANSLATIONS['en']?.[key] || key;
  };

  // --- FONKSÄ°YONLAR ---
  const sendMessage = async () => {
      if (!chatInput.trim() || !chatTarget || !user) return;
      const chatId = [user.uid, chatTarget.uid].sort().join('_');
      await addDoc(collection(db, "chats", chatId, "messages"), {
          text: chatInput,
          senderId: user.uid,
          timestamp: serverTimestamp()
      });
      setChatInput("");
  };
  const handleForgotPassword = async () => {
    if (!email.trim()) {
        Alert.alert("E-posta Gerekli", "Åžifre sÄ±fÄ±rlama baÄŸlantÄ±sÄ± iÃ§in lÃ¼tfen e-posta adresinizi yazÄ±n.");
        return;
    }
    try {
        await sendPasswordResetEmail(auth, email);
        Alert.alert("BaÅŸarÄ±lÄ±", "Åžifre sÄ±fÄ±rlama baÄŸlantÄ±sÄ± e-posta adresinize gÃ¶nderildi.");
    } catch (e: any) {
        Alert.alert("Hata", e.message);
    }
};
  const handleAuth = async () => {
      try {
          if (authMode === 'login') await signInWithEmailAndPassword(auth, email, password);
          else {
              const cred = await createUserWithEmailAndPassword(auth, email, password);
              await updateProfile(cred.user, { displayName: username });
              await setDoc(doc(db, "public_users", cred.user.uid), { uid: cred.user.uid, username: username.toLowerCase(), originalUsername: username, email });
          }
      } catch (e: any) { Alert.alert("Hata", e.message); }
  };

  const handleLogout = async () => { await signOut(auth); setTasks([]); };
  
const pickImage = async () => {
    try {
        console.log("Resim seÃ§me iÅŸlemi baÅŸladÄ±...");

        // 1. Ä°zin Ä°ste
        const permissionResult = await ImagePicker.requestMediaLibraryPermissionsAsync();
        if (permissionResult.granted === false) {
            alert("Galeri izni gerekli.");
            return;
        }

        // 2. Resmi SeÃ§
        const result = await ImagePicker.launchImageLibraryAsync({
            mediaTypes: ImagePicker.MediaTypeOptions.Images,
            allowsEditing: true,
            aspect: [1, 1],
            quality: 1, // Buradaki kalite Ã¶nemli deÄŸil, aÅŸaÄŸÄ±da manipulator ile ayarlayacaÄŸÄ±z
        });

        if (!result.canceled && result.assets && result.assets.length > 0) {
            const asset = result.assets[0];
            
            console.log("Resim seÃ§ildi, yeniden boyutlandÄ±rÄ±lÄ±yor...");

            // --- 3. RESMÄ° KÃœÃ‡ÃœLTME (RESIZE) Ä°ÅžLEMÄ° ---
            // GeniÅŸliÄŸi 500px yapÄ±yoruz, yÃ¼kseklik otomatik ayarlanÄ±yor.
            // Bu iÅŸlem boyutu 50KB - 150KB arasÄ±na dÃ¼ÅŸÃ¼rÃ¼r.
            const manipResult = await ImageManipulator.manipulateAsync(
                asset.uri,
                [{ resize: { width: 500 } }], // GeniÅŸliÄŸi 500px'e sabitle
                { 
                    compress: 0.7, // Kalite %70 (Gayet yeterli)
                    format: ImageManipulator.SaveFormat.JPEG, 
                    base64: true // Base64 verisini istiyoruz
                }
            );

            const finalBase64 = `data:image/jpeg;base64,${manipResult.base64}`;

            // Boyut KontrolÃ¼ (ArtÄ±k buraya takÄ±lmasÄ± imkansÄ±za yakÄ±n)
            if (finalBase64.length > 1048487) {
                alert("Resim kÃ¼Ã§Ã¼ltÃ¼lmesine raÄŸmen hala Ã§ok bÃ¼yÃ¼k.");
                return;
            }

            // 4. Kaydetme Ä°ÅŸlemleri
          

            await setDoc(doc(db, "users", user.uid), { photoURL: finalBase64 }, { merge: true });
            
            try {
                await setDoc(doc(db, "public_users", user.uid), { photoURL: finalBase64 }, { merge: true });
            } catch (e) {}

            setUser({ ...user, photoURL: finalBase64 });
            
            const msg = "Profil fotoÄŸrafÄ±n baÅŸarÄ±yla gÃ¼ncellendi!";
            Platform.OS === 'web' ? alert(msg) : Alert.alert("BaÅŸarÄ±lÄ±", msg);
        }
    } catch (e: any) {
        console.error("Hata:", e);
        const errMsg = "Resim iÅŸlenirken hata: " + e.message;
        Platform.OS === 'web' ? alert(errMsg) : Alert.alert("Hata", errMsg);
    }
  };

  const scheduleLocalNotification = async (title: string, body: string, timeString: string, type: 'notification' | 'alarm') => {
      if (Platform.OS === 'web') return null;
      try {
        const [hours, minutes] = timeString.split(':').map(Number);
        const triggerDate = new Date(selectedDate); triggerDate.setHours(hours, minutes, 0, 0);
        const id = await Notifications.scheduleNotificationAsync({ 
            content: { title: title, body: body, sound: true, priority: Notifications.AndroidNotificationPriority.HIGH, data: { type: type } }, 
            trigger: { type: Notifications.SchedulableTriggerInputTypes.DATE, date: triggerDate }, 
        });
        return id;
      } catch (e) { return null; }
  };

  const addTask = async () => {
      if (!inputValue.trim()) return;
      let notifId = null, alarmId = null;
      if (isNotifOn && notifInput.length === 5) notifId = await scheduleLocalNotification("HatÄ±rlatma", inputValue, notifInput, 'notification');
      if (isAlarmOn && alarmInput.length === 5) alarmId = await scheduleLocalNotification(t('alarm'), inputValue, alarmInput, t('alarm'));

      const formattedStart = convertDDMMYYYYtoISO(inputStartDate);
      const newTask = {
          text: inputValue, description: inputDesc, completed: false, date: formattedStart, dueDate: inputDueDate.length>=10?inputDueDate:null,
          showEveryDayUntilDue: isEveryDayOn, categoryId: selectedCategory.id, notificationTime: isNotifOn?notifInput:null, alarmTime: isAlarmOn?alarmInput:null, notificationId: notifId, alarmId: alarmId,
          createdAt: serverTimestamp(), assignedBy: user.uid, assignedByName: user.displayName, assignedTo: assignTarget ? assignTarget.uid : user.uid
      };
      
      if (assignTarget) {
          await addDoc(collection(db, "users", assignTarget.uid, "tasks"), newTask);
          Alert.alert("Ä°letildi", `${assignTarget.username} kiÅŸisine gÃ¶rev atandÄ±.`);
      } else {
          await addDoc(collection(db, "users", user.uid, "tasks"), newTask);
      }
      setIsAddModalOpen(false); 
      setInputValue(""); setInputDesc(""); setInputDueDate(""); 
      setNotifInput(""); setAlarmInput(""); setIsNotifOn(false); setIsAlarmOn(false); setIsEveryDayOn(false); setAssignTarget(null);
  };

  const addHabit = async () => {
      if (!newHabitTitle.trim()) return;
      const endDateISO = newHabitEndDate ? convertDDMMYYYYtoISO(newHabitEndDate) : null;
      let notificationIds: string[] = [];
      if (habitNotifInput.length === 5 && Platform.OS !== 'web') {
          const [hours, minutes] = habitNotifInput.split(':').map(Number);
          try {
              if (newHabitFreq === 'daily') {
                   // @ts-ignore
                   const id = await Notifications.scheduleNotificationAsync({ content: { title: "AlÄ±ÅŸkanlÄ±k Vakti!", body: newHabitTitle, sound: true }, trigger: { hour: hours, minute: minutes, repeats: true, type: Notifications.SchedulableTriggerInputTypes.CALENDAR } });
                   notificationIds.push(id);
              } else if (newHabitFreq === 'weekly') {
                   for (const dayIndex of newHabitDays) {
                       const expoWeekday = dayIndex + 1; 
                       // @ts-ignore
                       const id = await Notifications.scheduleNotificationAsync({ content: { title: "AlÄ±ÅŸkanlÄ±k Vakti!", body: newHabitTitle, sound: true }, trigger: { weekday: expoWeekday, hour: hours, minute: minutes, repeats: true, type: Notifications.SchedulableTriggerInputTypes.CALENDAR } });
                       notificationIds.push(id);
                   }
              }
          } catch(e) { console.log("Notif error", e); }
      }
      if (user) {
          await addDoc(collection(db, "users", user.uid, "habits"), { 
            title: newHabitTitle, frequency: newHabitFreq, selectedDays: newHabitDays, endDate: endDateISO, 
            completedDates: [], notificationTime: habitNotifInput, notificationIds: notificationIds, 
            categoryId: selectedCategory.id, // Kategori Eklendi
            createdAt: serverTimestamp() 
          });
      }
      setIsAddModalOpen(false);
      setNewHabitTitle(""); setNewHabitFreq('daily'); setNewHabitDays([]); setNewHabitEndDate(""); setHabitNotifInput("");
  };

  const toggleTask = async (task: Task) => { if(user) await updateDoc(doc(db, "users", user.uid, "tasks", task.id), { completed: !task.completed }); };
  const deleteTask = async (task: Task) => { if (user) { await deleteDoc(doc(db, "users", user.uid, "tasks", task.id)); } };
  
  const toggleHabitCompletion = async (habit: Habit, date: string) => {
      const ref = doc(db, "users", user.uid, "habits", habit.id);
      if (habit.completedDates.includes(date)) await updateDoc(ref, { completedDates: arrayRemove(date) });
      else await updateDoc(ref, { completedDates: arrayUnion(date) });
  };
  
  const deleteHabit = async (habit: Habit) => { 
      if (habit.notificationIds) {
          for(const id of habit.notificationIds) { if (Platform.OS !== 'web') await Notifications.cancelScheduledNotificationAsync(id); }
      }
      if (user) await deleteDoc(doc(db, "users", user.uid, "habits", habit.id)); 
  };

  const toggleExpand = (taskId: string) => { LayoutAnimation.configureNext(LayoutAnimation.Presets.easeInEaseOut); setExpandedTaskId(expandedTaskId === taskId ? null : taskId); };
  const openEditModal = (task: Task) => { if (task.assignedBy !== user.uid && task.assignedTo !== user.uid) { Alert.alert("Yetkisiz", "Bu gÃ¶revi dÃ¼zenleme yetkiniz yok."); return; } setSelectedTask(task); setDetailText(task.text); setDetailDesc(task.description || ""); setDetailDueDate(task.dueDate || ""); };
  const saveTaskDetail = async () => { if (!selectedTask) return; try { const targetUid = selectedTask.assignedTo || user.uid; const taskRef = doc(db, "users", targetUid, "tasks", selectedTask.id); await updateDoc(taskRef, { text: detailText, description: detailDesc, dueDate: detailDueDate }); setSelectedTask(null); Alert.alert("BaÅŸarÄ±lÄ±", "GÃ¶rev gÃ¼ncellendi."); } catch (e) { Alert.alert("Hata", "GÃ¼ncelleme baÅŸarÄ±sÄ±z."); } };
  
  const onDateChange = (event: any, selected: Date | undefined) => { 
      setShowDatePicker(false); 
      if (selected) { 
          const formatted = formatDateDDMMYYYY(selected);
          if (datePickerTarget === 'start') setInputStartDate(formatted);
          if (datePickerTarget === 'due') setInputDueDate(formatted);
          if (datePickerTarget === 'habitEnd') setNewHabitEndDate(formatted);
          if (datePickerTarget === 'detail') setDetailDueDate(formatted);
      } 
  };
  
  const onDetailDateChange = (event: any, selected: Date | undefined) => { 
      setShowDetailDatePicker(false); 
      if (selected) setDetailDueDate(formatDateDDMMYYYY(selected));
  };
  const onHabitDateChange = (event: any, selected: Date | undefined) => {
      setShowHabitDatePicker(false);
      if (selected) setNewHabitEndDate(formatDateDDMMYYYY(selected));
  };

  const openDatePicker = (target: 'start' | 'due' | 'habitEnd' | 'detail') => {
      setDatePickerTarget(target);
      setShowDatePicker(true);
  };

  const handleInputStartDateChange = (text: string) => { setInputStartDate(maskDateInput(text)); };
  const handleInputDueDateChange = (text: string) => { setInputDueDate(maskDateInput(text)); };
  const handleDetailDueDateChange = (text: string) => { setDetailDueDate(maskDateInput(text)); };
  const handleHabitEndDateChange = (text: string) => setNewHabitEndDate(maskDateInput(text));
  const handleNotifInputChange = (text: string) => { setNotifInput(maskTimeInput(text)); };
  const handleAlarmInputChange = (text: string) => { setAlarmInput(maskTimeInput(text)); };
  const handleHabitNotifInputChange = (text: string) => { setHabitNotifInput(maskTimeInput(text)); };
  const changeDate = (days: number) => { const newDate = new Date(selectedDate); newDate.setDate(selectedDate.getDate() + days); setSelectedDate(newDate); };
  const toggleHabitDay = (dayId: number) => { if (newHabitDays.includes(dayId)) setNewHabitDays(newHabitDays.filter(d => d !== dayId)); else setNewHabitDays([...newHabitDays, dayId]); };
  // ... mevcut fonksiyonlarÄ±n arasÄ±na ekleyin

  const handleAddCategory = async () => {
    if (!newCategoryName.trim()) return;
    const newId = Math.random().toString(36).substr(2, 9);
    
    const newCategory = { id: newId, name: newCategoryName, color: newCategoryColor };
    const updatedCategories = [...categories, newCategory];
    
    setCategories(updatedCategories);
    setNewCategoryName("");
    
    // FIREBASE KAYDI (Ã–NEMLÄ°)
    if (user) {
        try {
            // 'users' koleksiyonunda kullanÄ±cÄ±nÄ±n dÃ¶kÃ¼manÄ±na 'categories' alanÄ±nÄ± gÃ¼ncelliyoruz
            await setDoc(doc(db, "users", user.uid), { categories: updatedCategories }, { merge: true });
        } catch (e) {
            console.log("Kategori kaydedilemedi", e);
        }
    }
};

// Kategori silerken de updateDoc yapmalÄ±sÄ±nÄ±z:
const handleDeleteCategory = async (catId: string) => {
    if (categories.length <= 1) {
        Alert.alert(t('warning_label'), t('at_least_one_category'));
        return;
    }
    const updatedCategories = categories.filter(c => c.id !== catId);
    setCategories(updatedCategories);
    
    if (user) {
         await updateDoc(doc(db, "users", user.uid), { categories: updatedCategories });
    }
};

  const sendFriendRequest = async () => {
    if (!searchUsername.trim()) return;
    try {
      const q = query(collection(db, "public_users"), where("username", "==", searchUsername.toLowerCase()));
      const querySnapshot = await getDocs(q);
      if (querySnapshot.empty) { Alert.alert("BulunamadÄ±", "KullanÄ±cÄ± bulunamadÄ±."); return; }
      const targetUser = querySnapshot.docs[0].data();
      if (targetUser.uid === user.uid) { Alert.alert("Hata", "Kendini ekleyemezsin."); return; }
      const existingContact = contacts.find(c => c.uid === targetUser.uid);
      if (existingContact) { Alert.alert("Bilgi", "Bu kiÅŸi zaten listende."); return; }
      await setDoc(doc(db, "users", targetUser.uid, "friend_requests", user.uid), { fromUid: user.uid, fromUsername: user.displayName || user.email, fromEmail: user.email, status: 'pending', createdAt: serverTimestamp() });
      setSearchUsername(""); Alert.alert("GÃ¶nderildi", "Ä°stek gÃ¶nderildi.");
    } catch (e) { Alert.alert("Hata", "Ä°stek gÃ¶nderilemedi."); }
  };
  const acceptRequest = async (req: FriendRequest) => {
    try {
      await setDoc(doc(db, "users", user.uid, "contacts", req.fromUid), { uid: req.fromUid, username: req.fromUsername, email: req.fromEmail, canAssignToMe: true });
      await setDoc(doc(db, "users", req.fromUid, "contacts", user.uid), { uid: user.uid, username: user.displayName || user.email, email: user.email, canAssignToMe: false });
      await deleteDoc(doc(db, "users", user.uid, "friend_requests", req.id)); Alert.alert("BaÅŸarÄ±lÄ±", "BaÄŸlantÄ± kuruldu!");
    } catch (e) { Alert.alert("Hata", "Ä°ÅŸlem baÅŸarÄ±sÄ±z."); }
  };
  const rejectRequest = async (reqId: string) => { try { await deleteDoc(doc(db, "users", user.uid, "friend_requests", reqId)); } catch (e) { } };
  const togglePermission = async (contact: Contact) => { await updateDoc(doc(db, "users", user.uid, "contacts", contact.uid), { canAssignToMe: !contact.canAssignToMe }); };
  const setContactCategory = async (contact: Contact, categoryId: string) => { await updateDoc(doc(db, "users", user.uid, "contacts", contact.uid), { defaultCategoryId: categoryId }); };
  const fetchDeviceContacts = async () => {
      const { status } = await Contacts.requestPermissionsAsync();
      if (status === 'granted') {
          const { data } = await Contacts.getContactsAsync({ fields: [Contacts.Fields.PhoneNumbers, Contacts.Fields.Name] });
          if (data.length > 0) {
              const formattedContacts: DeviceContact[] = [];
              for (const contact of data) {
                  if (contact.phoneNumbers && contact.phoneNumbers.length > 0) {
                      let number = contact.phoneNumbers[0].number || "";
                      number = number.replace(/\s/g, '').replace(/-/g, '').replace(/\(/g, '').replace(/\)/g, '');
                      formattedContacts.push({ id: contact.id || Math.random().toString(), name: contact.name || "Ä°simsiz", phoneNumber: number, isAppUser: false });
                  }
              }
              setDeviceContacts(formattedContacts);
          }
      } else { Alert.alert("Ä°zin Gerekli", "Rehberinize eriÅŸmek iÃ§in izin vermelisiniz."); }
  };
  const inviteContact = async (phoneNumber: string) => {
      const isAvailable = await SMS.isAvailableAsync();
      if (isAvailable) { await SMS.sendSMSAsync([phoneNumber], "Merhaba, ben Ommio kullanÄ±yorum! https://ommio.app"); } else { Alert.alert("Hata", "SMS servisi kullanÄ±lamÄ±yor."); }
  };
const handleDeleteAccount = async () => {
    console.log("Silme fonksiyonu tetiklendi"); // Konsola log atalÄ±m

    // --- SÄ°LME MANTIÄžI (Tekrar kullanmak iÃ§in ayÄ±rdÄ±k) ---
    const performDelete = async () => {
        try {
            if (!user) return;
            console.log("Silme iÅŸlemi baÅŸlÄ±yor...");
            
            // 1. Firestore verilerini sil
            await deleteDoc(doc(db, "users", user.uid));
            try {
                await deleteDoc(doc(db, "public_users", user.uid));
            } catch (e) { console.log("Public user silinemedi veya yok", e); }

            // 2. Auth kullanÄ±cÄ±sÄ±nÄ± sil
            await user.delete();
            setTasks([]); 
            
            if (Platform.OS === 'web') {
                alert("HesabÄ±n baÅŸarÄ±yla silindi.");
            } else {
                Alert.alert("HoÅŸÃ§akal", "HesabÄ±n baÅŸarÄ±yla silindi.");
            }
        } catch (error: any) {
            console.log("Silme hatasÄ±:", error);
            const errMsg = "Hesap silinirken hata oluÅŸtu. LÃ¼tfen Ã§Ä±kÄ±ÅŸ yapÄ±p tekrar girdikten sonra deneyin.";
            if (Platform.OS === 'web') alert(errMsg);
            else Alert.alert("Hata", errMsg);
        }
    };

    // --- PLATFORM KONTROLÃœ ---
    if (Platform.OS === 'web') {
        // WEB Ä°Ã‡Ä°N: Standart tarayÄ±cÄ± onayÄ±
        const confirmed = confirm("Bu iÅŸlem geri alÄ±namaz. TÃ¼m verilerin silinecek. Emin misin?");
        if (confirmed) {
            await performDelete();
        }
    } else {
        // MOBÄ°L Ä°Ã‡Ä°N: Native Alert
        Alert.alert(
            "HesabÄ± Sil",
            "Bu iÅŸlem geri alÄ±namaz. TÃ¼m gÃ¶revlerin, alÄ±ÅŸkanlÄ±klarÄ±n ve verilerin silinecek. Emin misin?",
            [
                { text: "VazgeÃ§", style: "cancel" },
                { 
                    text: "Sil ve Bitir", 
                    style: "destructive", 
                    onPress: performDelete 
                }
            ]
        );
    }
};
  // --- UI HELPERS ---
  const isSystemDark = systemScheme === 'dark';
  const isDark = theme === 'system' ? isSystemDark : theme === 'dark';
  const currentColors = isDark ? { bg: COLORS.darkBg, surface: COLORS.darkSurface, text: '#fff', subText: '#94a3b8' } : { bg: COLORS.background, surface: COLORS.surface, text: COLORS.textDark, subText: COLORS.textLight };
  const getCategoryColor = (id: string) => CATEGORY_COLORS.find(c => c.id === (categories.find(cat => cat.id === id)?.color)) || CATEGORY_COLORS[0];

  const currentISODate = getISODate(selectedDate);
  const todaysTasks = tasks.filter(t => {
      if (t.date === currentISODate) return true;
      if (t.showEveryDayUntilDue && t.dueDate) return currentISODate >= t.date && currentISODate <= convertDDMMYYYYtoISO(t.dueDate);
      return false;
  });

  const activeTasks = todaysTasks.filter(t => !t.completed).sort((a,b) => parseDueDate(a.dueDate) - parseDueDate(b.dueDate));
  const completedTasks = todaysTasks.filter(t => t.completed);
  const overdueTasks = tasks.filter(t => !t.completed && !t.showEveryDayUntilDue && t.date < getISODate(new Date()));
  
  const todaysHabits = habits.filter(h => {
      if (h.endDate && h.endDate < currentISODate) return false;
      if (h.frequency === 'daily') return true;
      if (h.frequency === 'weekly') return h.selectedDays.includes(selectedDate.getDay());
      return false;
  }).sort((a,b) => (a.notificationTime || "24:00").localeCompare(b.notificationTime || "24:00"));

  const filteredContacts = contacts.filter(c => c.username.toLowerCase().includes(assignSearchText.toLowerCase()));

  const renderTask = (task: Task) => {
    const catInfo = categories.find(c => c.id === task.categoryId) || categories[0];
    const catColor = CATEGORY_COLORS.find(c => c.id === catInfo.color) || CATEGORY_COLORS[0];
    const isAssignedByOther = task.assignedBy && task.assignedBy !== user.uid;
    const isExpanded = expandedTaskId === task.id;
    const isMultiDay = task.showEveryDayUntilDue;

    return (
        <View key={task.id} style={[styles.taskCard, { backgroundColor: currentColors.surface, opacity: task.completed ? 0.6 : 1, borderLeftWidth: isAssignedByOther ? 4 : 0, borderLeftColor: COLORS.warning }]}>
            <TouchableOpacity onPress={() => toggleExpand(task.id)} style={{flexDirection:'row', alignItems:'center'}}>
                <TouchableOpacity onPress={() => toggleTask(task)} style={[styles.checkBox, task.completed ? { backgroundColor: COLORS.success, borderColor: COLORS.success } : { borderColor: '#cbd5e1' }]}>
                    {task.completed && <Check size={14} color="#fff" />}
                </TouchableOpacity>
                <View style={{flex:1}}>
                    <Text style={[styles.taskText, { color: currentColors.text, textDecorationLine: task.completed ? 'line-through' : 'none' }]}>{task.text}</Text>
                    <View style={styles.taskMeta}>
                        <View style={[styles.miniBadge, { backgroundColor: isDark ? '#334155' : catColor.bg }]}><View style={{width:6, height:6, borderRadius:3, backgroundColor: catColor.hex}} /><Text style={{fontSize:10, color: isDark ? '#fff' : catColor.hex, fontWeight:'bold'}}>{catInfo.name}</Text></View>
                        {isAssignedByOther && <View style={[styles.miniBadge, { backgroundColor: '#fef3c7' }]}><User size={10} color={COLORS.warning} /><Text style={{fontSize:10, color: COLORS.warning, fontWeight:'bold'}}>{task.assignedByName || 'Patron'}</Text></View>}
                        {task.dueDate && <View style={styles.metaItem}><CalendarClock size={10} color={COLORS.danger} /><Text style={{fontSize:10, color: COLORS.danger}}>{task.dueDate}</Text></View>}
                        {isMultiDay && <View style={styles.metaItem}><Repeat size={10} color={COLORS.primary} /><Text style={{fontSize:10, color: COLORS.primary}}>{t('every_day')}</Text></View>}
                        {task.notificationTime && (<View style={styles.metaItem}><Bell size={10} color={COLORS.primary} /><Text style={{fontSize:10, color: COLORS.primary}}>{task.notificationTime}</Text></View>)}
                    </View>
                </View>
                <View style={{marginLeft:10}}>{isExpanded ? <ChevronUp size={20} color={currentColors.subText} /> : <ChevronDown size={20} color={currentColors.subText} />}</View>
            </TouchableOpacity>
            {isExpanded && (
                <View style={{marginTop:15, paddingTop:15, borderTopWidth:1, borderColor: isDark ? '#334155' : '#f1f5f9'}}>
                    {task.description ? (<View style={{flexDirection:'row', gap:5, marginBottom:10}}><AlignLeft size={14} color={currentColors.subText} style={{marginTop:2}} /><Text style={{color: currentColors.text, fontSize:14, flex:1}}>{task.description}</Text></View>) : (<Text style={{color: currentColors.subText, fontSize:12, fontStyle:'italic', marginBottom:10}}>AÃ§Ä±klama yok.</Text>)}
                    <View style={{flexDirection:'row', justifyContent:'flex-end', gap:15, marginTop:5}}>
                        <TouchableOpacity onPress={() => deleteTask(task)} style={{flexDirection:'row', alignItems:'center', gap:5, padding:5}}><Trash2 size={16} color={COLORS.danger} /><Text style={{color: COLORS.danger, fontSize:12, fontWeight:'bold'}}>{t('delete')}</Text></TouchableOpacity>
                        {(task.assignedBy === user.uid || task.assignedTo === user.uid) && (<TouchableOpacity onPress={() => openEditModal(task)} style={{flexDirection:'row', alignItems:'center', gap:5, padding:5, backgroundColor: COLORS.primary + '20', borderRadius:8, paddingHorizontal:10}}><Edit2 size={16} color={COLORS.primary} /><Text style={{color: COLORS.primary, fontSize:12, fontWeight:'bold'}}>{t('edit')}</Text></TouchableOpacity>)}
                    </View>
                </View>
            )}
        </View>
    );
  };

  if (isAuthLoading) return <View style={[styles.container, { justifyContent:'center', alignItems:'center', backgroundColor: currentColors.bg }]}><ActivityIndicator size="large" color={COLORS.primary}/></View>;

  if (!user) {
    return (
      <KeyboardAvoidingView behavior={Platform.OS === "ios" ? "padding" : "height"} style={[styles.container, { backgroundColor: currentColors.bg, justifyContent:'center', padding: 20 }]}>
        <View style={{alignItems:'center', marginBottom: 40}}><View style={{width:80, height:80, backgroundColor: COLORS.primary, borderRadius: 20, alignItems:'center', justifyContent:'center', marginBottom:20}}><Trophy size={40} color="#fff" /></View><Text style={{fontSize:32, fontWeight:'900', color: currentColors.text}}>Ommio</Text><Text style={{color: currentColors.subText}}>Ä°ÅŸleri yoluna koy.</Text></View>
<View style={[styles.card, { backgroundColor: currentColors.surface, padding: 20 }]}>
            
            {/* 1. ÃœST MENÃœ: GiriÅŸ Yap / KayÄ±t Ol (ArtÄ±k E-posta/Telefon seÃ§imi yok) */}
            <View style={{flexDirection:'row', marginBottom: 20, borderBottomWidth:1, borderColor: isDark ? '#334155' : '#e2e8f0'}}>
                <TouchableOpacity onPress={()=>setAuthMode('login')} style={{flex:1, paddingBottom:10, borderBottomWidth: authMode==='login'?2:0, borderColor:COLORS.primary}}>
                    <Text style={{textAlign:'center', fontWeight:'bold', color: authMode==='login'?COLORS.primary:currentColors.subText}}>GiriÅŸ Yap</Text>
                </TouchableOpacity>
                <TouchableOpacity onPress={()=>setAuthMode('signup')} style={{flex:1, paddingBottom:10, borderBottomWidth: authMode==='signup'?2:0, borderColor:COLORS.primary}}>
                    <Text style={{textAlign:'center', fontWeight:'bold', color: authMode==='signup'?COLORS.primary:currentColors.subText}}>KayÄ±t Ol</Text>
                </TouchableOpacity>
            </View>

            {/* 2. INPUTLAR (KullanÄ±cÄ± AdÄ± sadece KayÄ±t modunda gÃ¶rÃ¼nÃ¼r) */}
            {authMode === 'signup' && (
                <View style={styles.authInputRow}>
                    <User size={20} color={currentColors.subText} />
                    <TextInput 
                        value={username} 
                        onChangeText={setUsername} 
                        placeholder="KullanÄ±cÄ± AdÄ±" 
                        placeholderTextColor={currentColors.subText} 
                        style={[styles.authInput, {color: currentColors.text}]} 
                        autoCapitalize='none' 
                    />
                </View>
            )}

            <View style={styles.authInputRow}>
                <Mail size={20} color={currentColors.subText} />
                <TextInput 
                    value={email} 
                    onChangeText={setEmail} 
                    placeholder="E-posta" 
                    placeholderTextColor={currentColors.subText} 
                    style={[styles.authInput, {color: currentColors.text}]} 
                    autoCapitalize='none' 
                    keyboardType="email-address"
                />
            </View>

            <View style={styles.authInputRow}>
                <Lock size={20} color={currentColors.subText} />
                <TextInput 
                    value={password} 
                    onChangeText={setPassword} 
                    placeholder="Åžifre" 
                    placeholderTextColor={currentColors.subText} 
                    style={[styles.authInput, {color: currentColors.text}]} 
                    secureTextEntry 
                />
            </View>

            {/* 3. GÄ°RÄ°Åž BUTONU */}
            <TouchableOpacity onPress={handleAuth} style={[styles.createBtn, {marginTop: 10}]}>
                <Text style={{color:'#fff', fontWeight:'bold', fontSize:16}}>
                    {authMode === 'login' ? 'GiriÅŸ Yap' : 'KayÄ±t Ol'}
                </Text>
            </TouchableOpacity>

            {/* 4. ÅžÄ°FREMÄ° UNUTTUM BUTONU (Sadece GiriÅŸ modunda) */}
            {authMode === 'login' && (
                <TouchableOpacity onPress={handleForgotPassword} style={{ marginTop: 15, alignSelf: 'center' }}>
                    <Text style={{ color: currentColors.subText, fontSize: 14 }}>Åžifremi unuttum?</Text>
                </TouchableOpacity>
            )}

        </View>
        <View style={{marginTop: 20, gap: 10}}>
           <TouchableOpacity disabled={!request} onPress={() => promptAsync()} style={[styles.socialBtn, {backgroundColor: currentColors.surface, flexDirection:'row', gap:10, justifyContent: 'center'}]}>
              <Globe size={20} color={currentColors.text} /> 
              <Text style={{color: currentColors.text, fontWeight:'600'}}>Google ile Devam Et</Text>
           </TouchableOpacity>
           
           {Platform.OS === 'ios' && (
             <AppleAuthentication.AppleAuthenticationButton 
               buttonType={AppleAuthentication.AppleAuthenticationButtonType.SIGN_IN} 
               buttonStyle={isDark ? AppleAuthentication.AppleAuthenticationButtonStyle.WHITE : AppleAuthentication.AppleAuthenticationButtonStyle.BLACK} 
               cornerRadius={12} 
               style={{ width: '100%', height: 50 }} 
               onPress={handleAppleLogin} 
             />
           )}
        </View>
      </KeyboardAvoidingView>
    );
  }

  return (
    <KeyboardAvoidingView behavior={Platform.OS === "ios" ? "padding" : "height"} style={{flex:1}}>
    <SafeAreaView style={[styles.container, { backgroundColor: currentColors.bg }]}>
      <StatusBar barStyle={isDark ? 'light-content' : 'dark-content'} />
      
      <View style={[styles.header, { justifyContent: 'center' }]}> 
        {/* Logoya basÄ±nca Ana Sayfaya (GÃ¶revler) dÃ¶n */}
        <TouchableOpacity onPress={() => setActiveTab('list')} activeOpacity={0.7}>
            <Image 
                source={require('../../assets/Logo/Logo.png')} 
                style={{ width: 150, height: 50, resizeMode: 'contain' }} 
            />
        </TouchableOpacity>
      </View>

      {/* DATE NAVIGATOR */}
      {activeTab === 'list' && (
          <View style={{marginBottom: 10}}>
            <View style={styles.dateNavContainer}><TouchableOpacity onPress={() => changeDate(-1)} style={styles.dateArrow}><ChevronLeft size={20} color={currentColors.subText} /></TouchableOpacity><View style={styles.dateDisplay}><Calendar size={14} color={COLORS.primary} style={{marginRight: 6}} /><Text style={[styles.dateText, { color: currentColors.text }]}>{selectedDate.getDate()}/{selectedDate.getMonth()+1} {selectedDate.getFullYear()}</Text>{getISODate(selectedDate) === getISODate(new Date()) && <View style={styles.todayBadge}><Text style={styles.todayText}>{t('today')}</Text></View>}</View><TouchableOpacity onPress={() => changeDate(1)} style={styles.dateArrow}><ChevronRight size={20} color={currentColors.subText} /></TouchableOpacity></View>
          </View>
      )}

      <ScrollView style={styles.content} contentContainerStyle={{ paddingBottom: 200 }} showsVerticalScrollIndicator={false}>
        {/* GÃ–REV LÄ°STESÄ° */}
        {activeTab === 'list' && (
            <View style={{gap: 12}}>
              {overdueTasks.length > 0 && (<View style={{marginBottom: 10}}><TouchableOpacity onPress={() => { LayoutAnimation.configureNext(LayoutAnimation.Presets.easeInEaseOut); setIsOverdueExpanded(!isOverdueExpanded); }} style={{flexDirection:'row', alignItems:'center', justifyContent:'space-between', padding:10, backgroundColor: isDark ? '#450a0a' : '#fef2f2', borderRadius:12, marginBottom: isOverdueExpanded ? 10 : 0, borderWidth:1, borderColor: COLORS.danger}}><View style={{flexDirection:'row', alignItems:'center', gap:10}}><AlertCircle size={20} color={COLORS.danger} /><Text style={{color: COLORS.danger, fontWeight:'bold'}}>{t('overdue')} ({overdueTasks.length})</Text></View>{isOverdueExpanded ? <ChevronUp size={20} color={COLORS.danger} /> : <ChevronDown size={20} color={COLORS.danger} />}</TouchableOpacity>{isOverdueExpanded && (<View style={{gap: 8}}>{overdueTasks.map(task => (<View key={task.id} style={[styles.taskCard, { backgroundColor: isDark ? '#450a0a' : '#fff', borderColor: COLORS.danger, borderWidth: 1 }]}><View style={{flex:1}}><Text style={[styles.taskText, { color: currentColors.text }]}>{task.text}</Text><Text style={{fontSize:10, color: COLORS.danger, marginTop:2}}>{task.date}</Text></View><TouchableOpacity onPress={() => deleteTask(task)}><Trash2 size={16} color={COLORS.danger} /></TouchableOpacity></View>))}</View>)}</View>)}
              
              {activeTasks.length > 0 ? activeTasks.map(task => renderTask(task)) : null}
              
              {completedTasks.length > 0 && (
                  <View style={{marginTop: 20}}>
                      {completedTasks.length === 1 ? (renderTask(completedTasks[0])) : (
                          <View><TouchableOpacity onPress={() => { LayoutAnimation.configureNext(LayoutAnimation.Presets.easeInEaseOut); setIsCompletedExpanded(!isCompletedExpanded); }} style={{flexDirection:'row', alignItems:'center', justifyContent:'space-between', padding:10, backgroundColor: currentColors.surface, borderRadius:12, marginBottom:10}}><View style={{flexDirection:'row', alignItems:'center', gap:10}}><CheckCircle2 size={20} color={COLORS.success} /><Text style={{color: currentColors.text, fontWeight:'bold'}}>{t('completed')} ({completedTasks.length})</Text></View>{isCompletedExpanded ? <ChevronUp size={20} color={currentColors.subText} /> : <ChevronDown size={20} color={currentColors.subText} />}</TouchableOpacity>{isCompletedExpanded && <View style={{opacity:0.7, gap:8}}>{completedTasks.map(task => renderTask(task))}</View>}</View>
                      )}
                  </View>
              )}

              {activeTasks.length === 0 && completedTasks.length === 0 && overdueTasks.length === 0 && (<View style={styles.emptyState}><View style={[styles.emptyIconBox, { backgroundColor: isDark ? '#1e293b' : '#e0e7ff' }]}><Check size={32} color={COLORS.primary} /></View><Text style={[styles.emptyTitle, { color: currentColors.text }]}>{t('all_good')}</Text><Text style={styles.emptyDesc}>{t('no_tasks_today')}</Text></View>)}
            </View>
        )}

        {/* ALIÅžKANLIK LÄ°STESÄ° */}
        {activeTab === 'habits' && (
            <View style={{gap: 15}}>
                {/* Date Navigator AlÄ±ÅŸkanlÄ±klar Sekmesinde De GÃ¶rÃ¼nsÃ¼n */}
                <View style={styles.dateNavContainer}><TouchableOpacity onPress={() => changeDate(-1)} style={styles.dateArrow}><ChevronLeft size={20} color={currentColors.subText} /></TouchableOpacity><View style={styles.dateDisplay}><Calendar size={14} color={COLORS.primary} style={{marginRight: 6}} /><Text style={[styles.dateText, { color: currentColors.text }]}>{selectedDate.getDate()}/{selectedDate.getMonth()+1} {selectedDate.getFullYear()}</Text>{getISODate(selectedDate) === getISODate(new Date()) && <View style={styles.todayBadge}><Text style={styles.todayText}>{t('today')}</Text></View>}</View><TouchableOpacity onPress={() => changeDate(1)} style={styles.dateArrow}><ChevronRight size={20} color={currentColors.subText} /></TouchableOpacity></View>

                {todaysHabits.length > 0 ? todaysHabits.map(habit => {
                    const isDone = habit.completedDates.includes(currentISODate);
                    const streak = habit.completedDates.length; 
                    const cat = categories.find(c=>c.id===habit.categoryId);
                    const cc = getCategoryColor(cat?.color || 'purple');

                    return (
                        <TouchableOpacity key={habit.id} onPress={() => toggleHabitCompletion(habit, currentISODate)} style={[styles.taskCard, {backgroundColor: currentColors.surface, opacity: isDone?0.8:1}]}>
                             <View style={{flexDirection:'row', alignItems:'center', justifyContent:'space-between'}}>
                                 <View style={{flexDirection:'row', alignItems:'center', gap:12}}>
                                     <View style={[styles.checkBox, isDone ? {backgroundColor:COLORS.primary, borderColor:COLORS.primary} : {borderColor: '#cbd5e1'}]}>{isDone && <Check size={14} color="#fff" />}</View>
                                     <View>
                                        <Text style={[styles.taskText, {color: currentColors.text, textDecorationLine: isDone?'line-through':'none'}]}>{habit.title}</Text>
                                        <View style={{flexDirection:'row', gap:5, marginTop:2}}>
                                            <View style={{flexDirection:'row', alignItems:'center', gap:3, backgroundColor:'#ffedd5', paddingHorizontal:5, borderRadius:4}}><Flame size={10} color="#f97316" /><Text style={{fontSize:10, color:'#f97316', fontWeight:'bold'}}>{streak} GÃ¼n</Text></View>
                                            <View style={{backgroundColor:cc.bg, paddingHorizontal:5, borderRadius:4}}><Text style={{fontSize:10, color:cc.hex}}>{cat?.name}</Text></View>
                                            {habit.notificationTime && <Text style={{fontSize:10, color:currentColors.subText}}>â° {habit.notificationTime}</Text>}
                                        </View>
                                     </View>
                                 </View>
                                 {/* WEB VE MOBÄ°L Ä°Ã‡Ä°N SÄ°LME BUTONU DÃœZELTÄ°LDÄ° */}
                                 <TouchableOpacity onPress={() => {
                                     if (Platform.OS === 'web') {
                                         if(confirm(t('delete_habit_confirm'))) deleteHabit(habit);
                                     } else {
                                         Alert.alert(t('delete'), t('delete_habit_confirm'), [{text:t('cancel')}, {text:t('delete'), style:"destructive", onPress:()=>deleteHabit(habit)}]);
                                     }
                                 }}><Trash2 size={16} color={currentColors.subText} /></TouchableOpacity>
                             </View>
                        </TouchableOpacity>
                    )
                }) : (
                    <View style={styles.emptyState}><View style={[styles.emptyIconBox, { backgroundColor: isDark ? '#1e293b' : '#e0e7ff' }]}><Repeat size={32} color={COLORS.primary} /></View><Text style={[styles.emptyTitle, { color: currentColors.text }]}>{t('new_habit')}!</Text><Text style={styles.emptyDesc}>{t('motivational_daily')}</Text></View>
                )}
            </View>
        )}

        {/* MESAJLAR LÄ°STESÄ° */}
        {activeTab === 'messages' && (
             <View style={{gap: 20, padding: 20}}>
                 {contacts.map(contact => (
                       <TouchableOpacity key={contact.uid} onPress={() => { setActiveTab('chat_room'); setChatTarget(contact); }} style={[styles.card, {backgroundColor:currentColors.surface, flexDirection:'row', alignItems:'center', marginBottom:10}]}>
                           <View style={{width:40, height:40, borderRadius:20, backgroundColor:COLORS.secondary, alignItems:'center', justifyContent:'center'}}><Text style={{fontWeight:'bold', color:'#fff'}}>{contact.username[0].toUpperCase()}</Text></View>
                           <View style={{marginLeft:15}}>
                               <Text style={{fontSize:16, fontWeight:'bold', color:currentColors.text}}>{contact.username}</Text>
                               <Text style={{fontSize:12, color:currentColors.subText}}>Sohbet etmek iÃ§in dokun</Text>
                           </View>
                           <ChevronRight size={20} color={currentColors.subText} style={{marginLeft:'auto'}} />
                       </TouchableOpacity>
                 ))}
                 {contacts.length === 0 && <Text style={{textAlign:'center', color:currentColors.subText}}>{t('no_connections')}</Text>}
             </View>
        )}

        {/* SOHBET ODASI */}
        {activeTab === 'chat_room' && chatTarget ? (
    <View style={{ flex: 1, backgroundColor: currentColors.bg }}>
        {/* ÃœST BAR */}
        <View style={{ flexDirection: 'row', alignItems: 'center', padding: 15, borderBottomWidth: 1, borderColor: isDark ? '#334155' : '#e2e8f0', backgroundColor: currentColors.surface }}>
            <TouchableOpacity onPress={() => setActiveTab('messages')} style={{ paddingRight: 10 }}>
                <ChevronLeft size={24} color={currentColors.text} />
            </TouchableOpacity>
            
            <View style={{width:36, height:36, borderRadius:18, backgroundColor:COLORS.secondary, alignItems:'center', justifyContent:'center', marginRight:10}}>
                <Text style={{color:'#fff', fontWeight:'bold'}}>{chatTarget.username[0].toUpperCase()}</Text>
            </View>

            <View style={{ flex: 1 }}>
                <Text style={{ fontSize: 16, fontWeight: 'bold', color: currentColors.text }}>{chatTarget.username}</Text>
                {/* YazÄ±yor Animasyonu veya Son GÃ¶rÃ¼lme */}
                {isTyping ? (
                    <Text style={{ fontSize: 12, color: COLORS.primary, fontStyle: 'italic' }}>yazÄ±yor...</Text>
                ) : (
                    <Text style={{ fontSize: 12, color: currentColors.subText }}>Ã‡evrimiÃ§i</Text>
                )}
            </View>
        </View>

        {/* MESAJ LÄ°STESÄ° (FLATLIST - INVERTED) */}
       <FlatList
    data={chatMessages} // ArtÄ±k reverse() yapmÄ±yoruz, sorgu zaten 'desc'
    inverted={true}     // En yeni mesaj en altta (inverted olduÄŸu iÃ§in aslÄ±nda en Ã¼stte) durur
    keyExtractor={item => item.id}
    contentContainerStyle={{ padding: 15 }}
    showsVerticalScrollIndicator={false}
    
    // PAGINATION TETÄ°KLEYÄ°CÄ°SÄ°
    onEndReached={() => {
        // KullanÄ±cÄ± yukarÄ± kaydÄ±rÄ±p listenin ucuna gelince 25 mesaj daha ekle
        setMsgLimit(prev => prev + 25);
    }}
    onEndReachedThreshold={0.5} // Listenin yarÄ±sÄ±na gelince tetikle
    
    renderItem={({ item: msg }) => {
        const isMe = msg.senderId === user.uid;
        return (
            <View style={{ alignSelf: isMe ? 'flex-end' : 'flex-start', maxWidth: '75%', marginBottom: 10 }}>
                <View style={{
                    backgroundColor: isMe ? COLORS.primary : (isDark ? '#334155' : '#fff'),
                    padding: 12,
                    borderRadius: 16,
                    borderBottomRightRadius: isMe ? 4 : 16,
                    borderBottomLeftRadius: isMe ? 16 : 4,
                    shadowColor: "#000", shadowOpacity: 0.05, shadowRadius: 2, elevation: 1
                }}>
                    <Text style={{ color: isMe ? '#fff' : currentColors.text, fontSize: 15 }}>{msg.text}</Text>
                    
                    {/* Mesaj DetaylarÄ± (Saat + Okundu Tikleri) */}
                    <View style={{ flexDirection: 'row', alignItems: 'center', justifyContent: 'flex-end', gap: 4, marginTop: 4 }}>
                        <Text style={{ fontSize: 10, color: isMe ? 'rgba(255,255,255,0.7)' : currentColors.subText }}>
                            {msg.timestamp ? new Date(msg.timestamp.seconds * 1000).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' }) : '...'}
                        </Text>
                        
                        {/* OKUNDU TÄ°KLERÄ° */}
                        {isMe && (
                            <View style={{ flexDirection: 'row' }}>
                                {/* Mesaj okunduysa (#a7f3d0 - aÃ§Ä±k yeÅŸil/mavi), deÄŸilse soluk beyaz */}
                                <Check size={12} color={msg.read ? '#a7f3d0' : 'rgba(255,255,255,0.6)'} /> 
                                {msg.read && <Check size={12} color='#a7f3d0' style={{ marginLeft: -8 }} />}
                            </View>
                        )}
                    </View>
                </View>
            </View>
        );
    }}
/>

        {/* MESAJ YAZMA ALANI */}
        <KeyboardAvoidingView behavior={Platform.OS === 'ios' ? 'padding' : undefined} keyboardVerticalOffset={Platform.OS === 'ios' ? 90 : 0}>
            <View style={{ flexDirection: 'row', padding: 10, paddingHorizontal: 15, alignItems: 'center', gap: 10, backgroundColor: currentColors.surface, borderTopWidth: 1, borderColor: isDark ? '#334155' : '#f1f5f9' }}>
                <TextInput
                    value={chatInput}
                    onChangeText={(text) => {
                        setChatInput(text);
                        // Burada "YazÄ±yor" durumunu Firestore'a yazan bir fonksiyon Ã§aÄŸrÄ±labilir
                    }}
                    placeholder="Mesaj yaz..."
                    placeholderTextColor={currentColors.subText}
                    style={{ flex: 1, backgroundColor: isDark ? '#1e293b' : '#f1f5f9', borderRadius: 24, paddingHorizontal: 20, paddingVertical: 10, maxHeight: 100, color: currentColors.text }}
                    multiline
                />
                <TouchableOpacity onPress={sendMessage} disabled={!chatInput.trim()} style={{ backgroundColor: chatInput.trim() ? COLORS.primary : (isDark ? '#334155' : '#e2e8f0'), width: 44, height: 44, borderRadius: 22, alignItems: 'center', justifyContent: 'center' }}>
                    <Send size={20} color={chatInput.trim() ? '#fff' : '#94a3b8'} style={{ marginLeft: 2 }} />
                </TouchableOpacity>
            </View>
        </KeyboardAvoidingView>
    </View>
) : null}

        {/* SOSYAL SEKME */}
        {activeTab === 'social' && (
            <View style={{gap: 20, padding: 20}}>
                <View style={{flexDirection:'row', justifyContent:'space-between', alignItems:'center'}}>
                    <Text style={{fontSize:20, fontWeight:'bold', color:currentColors.text}}>{t('friends')}</Text>
                    <TouchableOpacity onPress={() => setIsNetworkModalOpen(true)}><UserPlus size={20} color={COLORS.primary} /></TouchableOpacity>
                </View>
                {/* Ä°stekler */}
                {friendRequests.length > 0 && (
                  <View>
                      <Text style={{fontSize:12, fontWeight:'bold', color:currentColors.subText, marginBottom:10}}>GELEN Ä°STEKLER</Text>
                      {friendRequests.map(req => (
                          <View key={req.id} style={{backgroundColor: currentColors.surface, padding:15, borderRadius:16, marginBottom:10, flexDirection:'row', justifyContent:'space-between', alignItems:'center', borderLeftWidth:4, borderLeftColor:COLORS.warning}}>
                              <View><Text style={{color: currentColors.text, fontWeight:'bold'}}>{req.fromUsername}</Text></View>
                              <View style={{flexDirection:'row', gap:10}}><TouchableOpacity onPress={() => rejectRequest(req.id)}><XCircle size={28} color={COLORS.danger} /></TouchableOpacity><TouchableOpacity onPress={() => acceptRequest(req)}><UserCheck size={28} color={COLORS.success} /></TouchableOpacity></View>
                          </View>
                      ))}
                  </View>
                )}
                {/* Liste */}
                {contacts.map(contact => (
                      <View key={contact.uid} style={[styles.card, {backgroundColor:currentColors.surface, flexDirection:'row', alignItems:'center', marginBottom:10}]}>
                          <View style={{width:40, height:40, borderRadius:20, backgroundColor:COLORS.secondary, alignItems:'center', justifyContent:'center'}}><Text style={{fontWeight:'bold', color:'#fff'}}>{contact.username[0].toUpperCase()}</Text></View>
                          <View style={{marginLeft:15}}>
                              <Text style={{fontSize:16, fontWeight:'bold', color:currentColors.text}}>{contact.username}</Text>
                              <Text style={{fontSize:12, color:currentColors.subText}}>{contact.email}</Text>
                          </View>
                      </View>
                ))}
                {contacts.length === 0 && friendRequests.length === 0 && <Text style={{textAlign:'center', color:currentColors.subText}}>{t('no_users')}</Text>}
            </View>
        )}

        {/* PROFÄ°L SEKME */}
{activeTab === 'profile' && (
  <View style={{ gap: 15, padding: 20 }}>

    {/* 1. PROFÄ°L FOTOÄžRAFI KARTI */}
    <View style={[styles.card, { backgroundColor: currentColors.surface, alignItems:'center' }]}>
      <TouchableOpacity onPress={pickImage} style={{ alignItems: 'center' }}>
        {user.photoURL ? (
          <Image source={{uri: user.photoURL}} style={{width:80, height:80, borderRadius:40, marginBottom:10}} />
        ) : (
          <View style={{width:80, height:80, borderRadius:40, backgroundColor:COLORS.primary, alignItems:'center', justifyContent:'center', marginBottom:10}}>
            <User size={40} color="#fff" />
          </View>
        )}
        <Text style={{ color: COLORS.primary, fontWeight:'bold', textAlign:'center' }}>{t('change_photo')}</Text>
      </TouchableOpacity>
    </View>

    {/* 2. GENEL AYARLAR KARTI (Hepsi Bir Arada) */}
    <View style={[styles.card, { backgroundColor: currentColors.surface }]}>
        <Text style={[styles.cardTitle, { color: currentColors.text }]}>{t('settings')}</Text>
        
        {/* A. Kategorileri DÃ¼zenle */}
        <TouchableOpacity 
            onPress={() => setIsCategoryModalOpen(true)} 
            style={[styles.settingBtn, { marginBottom: 10, justifyContent: 'space-between' }]}
        >
            <View style={{flexDirection:'row', gap:10, alignItems:'center'}}>
                <Layers size={20} color={COLORS.primary} />
                <Text style={{ color: currentColors.text }}>{t('edit_categories')}</Text>
            </View>
            <ChevronRight size={16} color={currentColors.subText} />
        </TouchableOpacity>

        {/* B. Dil SeÃ§imi */}
        <TouchableOpacity 
             onPress={() => setIsLangModalOpen(true)} 
             style={[styles.settingBtn, { marginBottom: 15, justifyContent: 'space-between' }]}
        >
             <View style={{flexDirection:'row', gap:10, alignItems:'center'}}>
                 <Globe size={20} color={COLORS.primary} />
                 <Text style={{ color: currentColors.text }}>Dil / Language</Text>
             </View>
             <Text style={{fontSize: 20}}>{LANGUAGES.find(l => l.code === lang)?.flag}</Text>
        </TouchableOpacity>

        {/* C. Tema (GÃ¶rÃ¼nÃ¼m) */}
        <Text style={{fontSize:12, color:currentColors.subText, marginTop:5, marginBottom:10}}>{t('appearance')?.toUpperCase() || 'GÃ–RÃœNÃœM'}</Text>
        <View style={{flexDirection:'row', gap:10, marginBottom:15}}>
             <TouchableOpacity onPress={() => setTheme('light')} style={[styles.settingBtn, theme === 'light' && styles.settingBtnActive, {flex:1, justifyContent:'center'}]}>
                <Sun size={16} color={theme === 'light' ? COLORS.primary : currentColors.subText} />
                <Text style={{color: theme === 'light' ? COLORS.primary : currentColors.subText, fontSize:12}}>{t('theme_light')}</Text>
             </TouchableOpacity>
             <TouchableOpacity onPress={() => setTheme('dark')} style={[styles.settingBtn, theme === 'dark' && styles.settingBtnActive, {flex:1, justifyContent:'center'}]}>
                <Moon size={16} color={theme === 'dark' ? COLORS.primary : currentColors.subText} />
                <Text style={{color: theme === 'dark' ? COLORS.primary : currentColors.subText, fontSize:12}}>{t('theme_dark')}</Text>
             </TouchableOpacity>
             <TouchableOpacity onPress={() => setTheme('system')} style={[styles.settingBtn, theme === 'system' && styles.settingBtnActive, {flex:1, justifyContent:'center'}]}>
                <Monitor size={16} color={theme === 'system' ? COLORS.primary : currentColors.subText} />
                <Text style={{color: theme === 'system' ? COLORS.primary : currentColors.subText, fontSize:12}}>{t('theme_system')}</Text>
             </TouchableOpacity>
        </View>

        {/* D. Gizlilik PolitikasÄ± Linki (MaÄŸazalar iÃ§in zorunlu) */}
        <TouchableOpacity onPress={() => Linking.openURL('https://ommio.app/privacy')} style={{paddingTop:15, borderTopWidth:1, borderColor: isDark?'#334155':'#f1f5f9'}}>
             <Text style={{color: COLORS.primary, textAlign:'center', fontSize:12, fontWeight:'600'}}>Gizlilik PolitikasÄ± ve Åžartlar</Text>
        </TouchableOpacity>
    </View>

    {/* 3. Ã‡IKIÅž YAP KARTI */}
    
    <View style={[styles.card, { backgroundColor: currentColors.surface }]}>
      <TouchableOpacity onPress={handleLogout} style={{flexDirection:'row', alignItems:'center', gap:10, padding:15, backgroundColor:'#fee2e2', borderRadius:12, justifyContent:'center'}}>
        <LogOut size={20} color={COLORS.danger} />
        <Text style={{color: COLORS.danger, fontWeight:'bold', fontSize:16}}>{t('logout')}</Text>
      </TouchableOpacity>
    </View>

    <View style={{ marginTop: 15, paddingTop: 15, borderTopWidth: 1, borderColor: isDark ? '#334155' : '#f1f5f9' }}>
        <TouchableOpacity 
            onPress={handleDeleteAccount} 
            style={{
                flexDirection: 'row', 
                alignItems: 'center', 
                gap: 10, 
                padding: 10, 
                justifyContent: 'center'
            }}
        >
            <Trash2 size={20} color={currentColors.subText} />
            <Text style={{ color: currentColors.subText, fontWeight: '600', fontSize: 14 }}>
                HesabÄ±mÄ± Sil
            </Text>
        </TouchableOpacity>
    </View>
    
  </View>
  
)}
      </ScrollView>
        
      {/* BOTTOM TABS (YENÄ° DÃœZEN) */}
      {!isSettingsOpen && (
      <View style={[styles.tabBar, { backgroundColor: currentColors.surface, borderTopColor: isDark?'#334155':'#e2e8f0' }]}>
          <TouchableOpacity onPress={() => setActiveTab('list')} style={{alignItems:'center', opacity: activeTab==='list'?1:0.5}}><ListTodo size={24} color={activeTab==='list'?COLORS.primary:currentColors.subText} /><Text style={{fontSize:10, color:activeTab==='list'?COLORS.primary:currentColors.subText}}>{t('tasks_tab')}</Text></TouchableOpacity>
          <TouchableOpacity onPress={() => setActiveTab('habits')} style={{alignItems:'center', opacity: activeTab==='habits'?1:0.5}}><Repeat size={24} color={activeTab==='habits'?COLORS.primary:currentColors.subText} /><Text style={{fontSize:10, color:activeTab==='habits'?COLORS.primary:currentColors.subText}}>{t('habits_tab')}</Text></TouchableOpacity>
          <TouchableOpacity onPress={() => setActiveTab('messages')} style={{alignItems:'center', opacity: (activeTab==='messages'||activeTab==='chat_room')?1:0.5}}><MessageCircle size={24} color={(activeTab==='messages'||activeTab==='chat_room')?COLORS.primary:currentColors.subText} /><Text style={{fontSize:10, color:(activeTab==='messages'||activeTab==='chat_room')?COLORS.primary:currentColors.subText}}>{t('messages_tab')}</Text></TouchableOpacity>
          <TouchableOpacity onPress={() => setActiveTab('social')} style={{alignItems:'center', opacity: activeTab==='social'?1:0.5}}><Users size={24} color={activeTab==='social'?COLORS.primary:currentColors.subText} /><Text style={{fontSize:10, color:activeTab==='social'?COLORS.primary:currentColors.subText}}>{t('social_tab')}</Text></TouchableOpacity>
          <TouchableOpacity onPress={() => setActiveTab('profile')} style={{alignItems:'center', opacity: activeTab==='profile'?1:0.5}}><User size={24} color={activeTab==='profile'?COLORS.primary:currentColors.subText} /><Text style={{fontSize:10, color:activeTab==='profile'?COLORS.primary:currentColors.subText}}>{t('profile_tab')}</Text></TouchableOpacity>
      </View>
      )}
      
      {/* YENÄ°: ALIÅžKANLIK EKLEME BUTONU (Sadece Habits sekmesinde) */}
      {!isSettingsOpen && activeTab === 'habits' && (
          <View style={[styles.floatingInputWrapper, {alignItems:'flex-end', backgroundColor:'transparent', shadowOpacity:0}]}>
              <TouchableOpacity onPress={() => { setAddMode('habit'); setIsAddModalOpen(true); }} style={[styles.sendBtn, {backgroundColor: COLORS.primary, width:56, height:56, borderRadius:28, shadowColor:COLORS.primary, shadowOpacity:0.3, shadowRadius:10, elevation:5}]}>
                  <Plus size={28} color="#fff" />
              </TouchableOpacity>
          </View>
      )}

    {/* GÃ–REV EKLEME BAR (SADECE GÃ–REVLER SEKMESÄ°NDE) */}
{!isSettingsOpen && activeTab === 'list' && (
    <>
        {/* 1. DIÅžARI TIKLAMA KATMANI (Sadece geniÅŸletilmiÅŸse gÃ¶rÃ¼nÃ¼r) */}
        {isInputExpanded && (
            <TouchableWithoutFeedback onPress={() => {
                LayoutAnimation.configureNext(LayoutAnimation.Presets.easeInEaseOut); // KapanÄ±ÅŸ animasyonu
                setIsInputExpanded(false);
                Keyboard.dismiss();
            }}>
                <View style={{
                    position: 'absolute',
                    top: 0, bottom: 0, left: 0, right: 0,
                    backgroundColor: 'rgba(0,0,0,0.2)', // Hafif karartma (Ä°sterseniz 0.0 yapÄ±p gÃ¶rÃ¼nmez yapabilirsiniz)
                    zIndex: 40 // Ä°Ã§erikten yÃ¼ksek, Bardan dÃ¼ÅŸÃ¼k olmalÄ±
                }} />
            </TouchableWithoutFeedback>
        )}

        {/* 2. GÃ–REV EKLEME KUTUSU */}
        <BlurView intensity={Platform.OS === 'ios' ? 80 : 100} // BulanÄ±klÄ±k ÅŸiddeti
          tint={isDark ? 'dark' : 'light'} // Temaya gÃ¶re cam rengi
          style={[styles.floatingInputWrapper, { 
              backgroundColor: isDark ? 'rgba(30, 41, 59, 0.6)' : 'rgba(255, 255, 255, 0.65)', // YarÄ± saydam arka plan
              borderColor: isDark ? 'rgba(255,255,255,0.1)' : 'rgba(255,255,255,0.4)', // Ä°nce cam kenarlÄ±ÄŸÄ±
              borderWidth: 1, overflow: 'hidden', // Blur'un kÃ¶ÅŸelerden taÅŸmamasÄ± iÃ§in ÅŸart
              zIndex: 50}]}>

            {/* ... Ä°Ã‡ERÄ°K AYNEN KALIYOR ... */}
            {isInputExpanded && (
                <View style={styles.expandedOptions}>
                    <Text style={{ fontSize: 10, fontWeight: 'bold', color: currentColors.subText, marginBottom: 5, marginTop: 5 }}>{t('assign_to')}</Text>
                    <View style={{ flexDirection: 'row', gap: 5, marginBottom: 10, alignItems: 'center', borderBottomWidth: 1, borderColor: isDark ? '#334155' : '#f1f5f9', paddingBottom: 10 }}>
                        <Search size={16} color={currentColors.subText} />
                        <TextInput value={assignSearchText} onChangeText={setAssignSearchText} placeholder={t('search_contact')} placeholderTextColor={currentColors.subText} style={{ flex: 1, color: currentColors.text }} onSubmitEditing={addTask} />
                    </View>
                    <ScrollView horizontal showsHorizontalScrollIndicator={false} style={{ paddingBottom: 10 }}>
                        <TouchableOpacity onPress={() => setAssignTarget(null)} style={[styles.pill, !assignTarget ? { backgroundColor: COLORS.primary, borderColor: COLORS.primary } : { borderColor: isDark ? '#334155' : '#e2e8f0' }]}><User size={12} color={!assignTarget ? '#fff' : currentColors.text} /><Text style={{ fontSize: 12, color: !assignTarget ? '#fff' : currentColors.text, fontWeight: '600' }}>{t('me')}</Text></TouchableOpacity>
                        {filteredContacts.map(contact => (<TouchableOpacity key={contact.uid} onPress={() => setAssignTarget(contact)} style={[styles.pill, assignTarget?.uid === contact.uid ? { backgroundColor: COLORS.secondary, borderColor: COLORS.secondary } : { borderColor: isDark ? '#334155' : '#e2e8f0' }]}><Users size={12} color={assignTarget?.uid === contact.uid ? '#fff' : currentColors.text} /><Text style={{ fontSize: 12, color: assignTarget?.uid === contact.uid ? '#fff' : currentColors.text, fontWeight: '600' }}>{contact.username}</Text></TouchableOpacity>))}
                    </ScrollView>

                    <View style={{ marginBottom: 10 }}>
                        <Text style={{ fontSize: 10, fontWeight: 'bold', color: currentColors.subText, marginBottom: 5 }}>{t('description')}</Text>
                        <TextInput value={inputDesc} onChangeText={setInputDesc} placeholder="..." placeholderTextColor={currentColors.subText} style={[styles.smallInput, { backgroundColor: currentColors.bg, color: currentColors.text }]} onSubmitEditing={addTask} />
                    </View>

                    <View style={{ flexDirection: 'row', gap: 10, marginBottom: 10 }}>
                        <View style={{ flex: 1 }}>
                            <Text style={{ fontSize: 10, fontWeight: 'bold', color: currentColors.subText, marginBottom: 5 }}>{t('start_date')}</Text>
                            <View style={{ flexDirection: 'row', alignItems: 'center' }}>
                                <TextInput value={inputStartDate} onChangeText={handleInputStartDateChange} placeholder="DD-MM-YYYY" placeholderTextColor={currentColors.subText} maxLength={10} keyboardType="numeric" style={[styles.smallInput, { backgroundColor: currentColors.bg, color: currentColors.text, flex: 1, borderTopRightRadius: 0, borderBottomRightRadius: 0 }]} onSubmitEditing={addTask} />
                                <TouchableOpacity onPress={() => openDatePicker('start')} style={{ backgroundColor: COLORS.primary, padding: 7, borderTopRightRadius: 8, borderBottomRightRadius: 8, height: 36, justifyContent: 'center' }}><Calendar size={16} color="#fff" /></TouchableOpacity>
                            </View>
                        </View>
                        <View style={{ flex: 1 }}>
                            <Text style={{ fontSize: 10, fontWeight: 'bold', color: currentColors.subText, marginBottom: 5 }}>{t('due_date')}</Text>
                            <View style={{ flexDirection: 'row', alignItems: 'center' }}>
                                <TextInput value={inputDueDate} onChangeText={handleInputDueDateChange} placeholder="DD-MM-YYYY" placeholderTextColor={currentColors.subText} maxLength={10} keyboardType="numeric" style={[styles.smallInput, { backgroundColor: currentColors.bg, color: currentColors.text, flex: 1, borderTopRightRadius: 0, borderBottomRightRadius: 0 }]} onSubmitEditing={addTask} />
                                <TouchableOpacity onPress={() => openDatePicker('due')} style={{ backgroundColor: COLORS.primary, padding: 7, borderTopRightRadius: 8, borderBottomRightRadius: 8, height: 36, justifyContent: 'center' }}><Calendar size={16} color="#fff" /></TouchableOpacity>
                            </View>
                        </View>
                    </View>

                    {!assignTarget && (<ScrollView horizontal showsHorizontalScrollIndicator={false} style={{ paddingVertical: 10, borderTopWidth: 1, borderColor: isDark ? '#334155' : '#f1f5f9' }}>{categories.map(cat => { const cc = CATEGORY_COLORS.find(c => c.id === cat.color) || CATEGORY_COLORS[0]; return (<TouchableOpacity key={cat.id} onPress={() => setSelectedCategory(cat)} style={[styles.pill, selectedCategory.id === cat.id ? { backgroundColor: cc.bg, borderColor: cc.hex } : { borderColor: isDark ? '#334155' : '#e2e8f0' }]}><View style={{ width: 8, height: 8, borderRadius: 4, backgroundColor: cc.hex }} /><Text style={{ fontSize: 12, color: currentColors.text, fontWeight: '600' }}>{cat.name}</Text></TouchableOpacity>) })}</ScrollView>)}
                    <View style={{ flexDirection: 'row', justifyContent: 'space-between', paddingTop: 10 }}><View style={{ flexDirection: 'row', gap: 5 }}><TouchableOpacity onPress={() => setIsNotifOn(!isNotifOn)} style={[styles.iconToggle, isNotifOn && { backgroundColor: '#eff6ff', borderColor: '#3b82f6' }]}><Bell size={16} color={isNotifOn ? '#3b82f6' : currentColors.subText} /></TouchableOpacity><TouchableOpacity onPress={() => setIsAlarmOn(!isAlarmOn)} style={[styles.iconToggle, isAlarmOn && { backgroundColor: '#fef2f2', borderColor: '#ef4444' }]}><AlarmClock size={16} color={isAlarmOn ? '#ef4444' : currentColors.subText} /></TouchableOpacity>{inputDueDate && <TouchableOpacity onPress={() => setIsEveryDayOn(!isEveryDayOn)} style={[styles.iconToggle, isEveryDayOn && { backgroundColor: '#f0fdf4', borderColor: '#10b981' }, { width: 'auto', paddingHorizontal: 8, gap: 5 }]}><CalendarDays size={16} color={isEveryDayOn ? '#10b981' : currentColors.subText} /><Text style={{ fontSize: 10, fontWeight: 'bold', color: isEveryDayOn ? '#10b981' : currentColors.subText }}>{t('every_day')}</Text></TouchableOpacity>}</View><View style={{ flexDirection: 'row', gap: 5 }}>{isNotifOn && <TextInput value={notifInput} onChangeText={handleNotifInputChange} placeholder="09:00" placeholderTextColor="#94a3b8" style={[styles.tinyInput, { color: COLORS.primary, borderColor: COLORS.primary }]} maxLength={5} onSubmitEditing={addTask} />}{isAlarmOn && <TextInput value={alarmInput} onChangeText={handleAlarmInputChange} placeholder="07:00" placeholderTextColor="#94a3b8" style={[styles.tinyInput, { color: COLORS.danger, borderColor: COLORS.danger }]} maxLength={5} onSubmitEditing={addTask} />}</View></View>
                </View>
            )}
            <View style={styles.inputMainRow}><TouchableOpacity onPress={() => { LayoutAnimation.configureNext(LayoutAnimation.Presets.easeInEaseOut); setIsInputExpanded(!isInputExpanded); }} style={styles.expandBtn}>{isInputExpanded ? <X size={20} color={currentColors.subText} /> : <Sliders size={20} color={currentColors.subText} />}</TouchableOpacity><TextInput value={inputValue} onChangeText={setInputValue} placeholder={t('addTask')} placeholderTextColor={currentColors.subText} style={[styles.mainInput, { color: currentColors.text }]} onFocus={() => { /* ArtÄ±k oto aÃ§Ä±lmÄ±yor */ }} onSubmitEditing={addTask} /><TouchableOpacity onPress={addTask} style={[styles.sendBtn, { backgroundColor: inputValue.trim() ? (assignTarget ? COLORS.warning : COLORS.primary) : (isDark ? '#334155' : '#e2e8f0') }]}><Plus size={24} color={inputValue.trim() ? '#fff' : '#94a3b8'} /></TouchableOpacity></View>
        </BlurView>
        
    </>
)}

     {/* EKLEME MODALI (AlÄ±ÅŸkanlÄ±klar iÃ§in) */}
<Modal visible={isAddModalOpen} animationType="slide" transparent>
    {/* 1. DIÅž KATMAN: Buraya (arka plana) basÄ±nca modal kapanÄ±r ve klavye iner */}
    <TouchableWithoutFeedback onPress={() => { setIsAddModalOpen(false); Keyboard.dismiss(); }}>
        <View style={{ flex: 1, justifyContent: 'flex-end', backgroundColor: 'rgba(0,0,0,0.5)' }}>

            {/* 2. Ä°Ã‡ KATMAN: Beyaz alana basÄ±nca kapanmayÄ± engellemek iÃ§in boÅŸ bir Touchable ekliyoruz */}
            <TouchableWithoutFeedback>
                <View style={{ backgroundColor: currentColors.bg, padding: 20, borderTopLeftRadius: 20, borderTopRightRadius: 20, minHeight: 400 }}>
                    
                    {/* --- Ä°Ã‡ERÄ°K BAÅžLANGICI (HÄ°Ã‡BÄ°R ÅžEY DEÄžÄ°ÅžMEDÄ°) --- */}
                    <View style={{ flexDirection: 'row', justifyContent: 'space-between', marginBottom: 20 }}>
                        <Text style={{ fontSize: 20, fontWeight: 'bold', color: currentColors.text }}>{t('new_habit')}</Text>
                        <TouchableOpacity onPress={() => setIsAddModalOpen(false)}><X size={24} color={currentColors.text} /></TouchableOpacity>
                    </View>
                    
                    <View style={{ gap: 15 }}>
                        <TextInput placeholder={t('habit_name')} placeholderTextColor={currentColors.subText} value={newHabitTitle} onChangeText={setNewHabitTitle} style={[styles.input, { color: currentColors.text }]} />
                        <View style={{ flexDirection: 'row', gap: 10 }}>
                            <TouchableOpacity onPress={() => setNewHabitFreq('daily')} style={[styles.pill, newHabitFreq === 'daily' && { backgroundColor: COLORS.primary }]}><Text style={{ color: newHabitFreq === 'daily' ? '#fff' : currentColors.text }}>{t('daily')}</Text></TouchableOpacity>
                            <TouchableOpacity onPress={() => setNewHabitFreq('weekly')} style={[styles.pill, newHabitFreq === 'weekly' && { backgroundColor: COLORS.primary }]}><Text style={{ color: newHabitFreq === 'weekly' ? '#fff' : currentColors.text }}>{t('weekly')}</Text></TouchableOpacity>
                        </View>
                        
                        {newHabitFreq === 'weekly' && (
                            <View style={{ marginTop: 10 }}>
                                <Text style={{ fontSize: 12, color: currentColors.subText, marginBottom: 8 }}>{t('which_days')}</Text>
                                <View style={{ flexDirection: 'row', flexWrap: 'wrap', gap: 8 }}>
                                    {getDaysOfWeek(lang).map((dayObj) => {
                                        const isSelected = newHabitDays.includes(dayObj.id);
                                        return (
                                            <TouchableOpacity
                                                key={dayObj.id}
                                                onPress={() => toggleHabitDay(dayObj.id)}
                                                style={{
                                                    width: 36, height: 36, borderRadius: 18,
                                                    backgroundColor: isSelected ? COLORS.primary : (isDark ? '#334155' : '#f1f5f9'),
                                                    alignItems: 'center', justifyContent: 'center',
                                                    borderWidth: 1, borderColor: isSelected ? COLORS.primary : (isDark ? '#475569' : '#e2e8f0')
                                                }}
                                            >
                                                <Text style={{ fontSize: 10, fontWeight: 'bold', color: isSelected ? '#fff' : currentColors.text }}>
                                                    {dayObj.label.substring(0, 2)} {/* SÄ±ÄŸmasÄ± iÃ§in ilk 2 harf */}
                                                </Text>
                                            </TouchableOpacity>
                                        );
                                    })}
                                </View>
                            </View>
                        )}

                        <TextInput placeholder={t('time_placeholder')} placeholderTextColor={currentColors.subText} value={habitNotifInput} onChangeText={(t) => setHabitNotifInput(maskTimeInput(t))} style={[styles.input, { color: currentColors.text }]} maxLength={5} keyboardType="numeric" />
                        <Text style={{ color: currentColors.subText, fontSize: 10 }}>{t('category')}</Text>
                        <ScrollView horizontal>{categories.map(c => <TouchableOpacity key={c.id} onPress={() => setSelectedCategory(c)} style={{ padding: 8, marginRight: 5, borderRadius: 8, backgroundColor: selectedCategory.id === c.id ? COLORS.secondary : currentColors.surface }}><Text style={{ color: currentColors.text }}>{c.name}</Text></TouchableOpacity>)}</ScrollView>
                        <TouchableOpacity onPress={addHabit} style={styles.btn}><Text style={{ color: '#fff', fontWeight: 'bold' }}>{t('start_habit')}</Text></TouchableOpacity>
                    </View>
                    {/* --- Ä°Ã‡ERÄ°K BÄ°TÄ°ÅžÄ° --- */}

                </View>
            </TouchableWithoutFeedback>
        </View>
    </TouchableWithoutFeedback>
</Modal>

      {/* DATE PICKER MODAL */}
      {showDatePicker && (Platform.OS === 'ios' ? (<Modal transparent visible={true} animationType="fade"><View style={{flex:1, justifyContent:'center', alignItems:'center', backgroundColor:'rgba(0,0,0,0.5)'}}><View style={{backgroundColor:'white', padding:20, borderRadius:10}}><DateTimePicker value={new Date()} mode="date" display="inline" onChange={onDateChange} /><TouchableOpacity onPress={()=>setShowDatePicker(false)} style={{padding:10, alignItems:'center'}}><Text style={{color:COLORS.primary, fontWeight:'bold'}}>{t('close')}</Text></TouchableOpacity></View></View></Modal>) : (<DateTimePicker value={new Date()} mode="date" display="default" onChange={onDateChange} />))}
      {showDetailDatePicker && (Platform.OS === 'ios' ? (<Modal transparent visible={true} animationType="slide"><View style={{flex:1, justifyContent:'flex-end', backgroundColor:'rgba(0,0,0,0.3)'}}><View style={{backgroundColor: currentColors.surface, padding:20, borderTopLeftRadius:20, borderTopRightRadius:20}}><View style={{flexDirection:'row', justifyContent:'space-between', marginBottom:10}}><TouchableOpacity onPress={() => setShowDetailDatePicker(false)}><Text style={{color:COLORS.danger}}>{t('cancel')}</Text></TouchableOpacity><TouchableOpacity onPress={() => setShowDetailDatePicker(false)}><Text style={{color:COLORS.primary, fontWeight:'bold'}}>{t('ok_btn')}</Text></TouchableOpacity></View><DateTimePicker value={new Date()} mode="date" display="inline" onChange={onDetailDateChange} /></View></View></Modal>) : (<DateTimePicker value={new Date()} mode="date" display="default" onChange={onDetailDateChange} />))}
      {showHabitDatePicker && Platform.OS === 'android' && (<DateTimePicker value={new Date()} mode="date" display="default" onChange={onHabitDateChange} />)}
      <Modal transparent visible={showHabitDatePicker && Platform.OS === 'ios'} animationType="slide"><View style={{flex:1, justifyContent:'flex-end', backgroundColor:'rgba(0,0,0,0.3)'}}><View style={{backgroundColor: currentColors.surface, padding:20, borderTopLeftRadius:20, borderTopRightRadius:20}}><View style={{flexDirection:'row', justifyContent:'space-between', marginBottom:10}}><TouchableOpacity onPress={() => setShowHabitDatePicker(false)}><Text style={{color:COLORS.danger}}>{t('cancel')}</Text></TouchableOpacity><TouchableOpacity onPress={() => setShowHabitDatePicker(false)}><Text style={{color:COLORS.primary, fontWeight:'bold'}}>{t('ok_btn')}</Text></TouchableOpacity></View><DateTimePicker value={new Date()} mode="date" display="inline" onChange={onHabitDateChange} /></View></View></Modal>
      
      <Modal visible={!!selectedTask} animationType="slide" presentationStyle="pageSheet"><View style={[styles.container, {backgroundColor: currentColors.bg, padding:20}]}><View style={{flexDirection:'row', justifyContent:'space-between', alignItems:'center', marginBottom:20}}><Text style={{fontSize:18, fontWeight:'bold', color: currentColors.text}}>{t('edit')}</Text><TouchableOpacity onPress={() => setSelectedTask(null)}><Text style={{color:COLORS.primary, fontWeight:'bold'}}>{t('close')}</Text></TouchableOpacity></View>{selectedTask && (<View style={{gap:15}}><View><Text style={{color: currentColors.subText, fontSize:12, marginBottom:5}}>{t('title_label')}</Text><TextInput value={detailText} onChangeText={setDetailText} style={[styles.authInput, {backgroundColor: currentColors.surface, color: currentColors.text, height:50, borderRadius:12, paddingHorizontal:15}]} /></View><View><Text style={{color: currentColors.subText, fontSize:12, marginBottom:5}}>{t('description')}</Text><TextInput value={detailDesc} onChangeText={setDetailDesc} multiline numberOfLines={4} placeholder={t('add_note_placeholder')} placeholderTextColor={currentColors.subText} style={[styles.authInput, {backgroundColor: currentColors.surface, color: currentColors.text, height:100, borderRadius:12, paddingHorizontal:15, paddingTop:15, textAlignVertical:'top'}]} /></View><View><Text style={{color: currentColors.subText, fontSize:12, marginBottom:5}}>{t('due_date')} (DD-MM-YYYY)</Text><View style={{flexDirection:'row', alignItems:'center'}}><TextInput value={detailDueDate} onChangeText={handleDetailDueDateChange} placeholder="DD-MM-YYYY" placeholderTextColor={currentColors.subText} maxLength={10} keyboardType="numeric" style={[styles.authInput, {backgroundColor: currentColors.surface, color: currentColors.text, height:50, borderRadius:12, paddingHorizontal:15, flex:1, borderTopRightRadius:0, borderBottomRightRadius:0}]} /><TouchableOpacity onPress={() => openDatePicker('detail')} style={{backgroundColor: COLORS.primary, padding:10, borderTopRightRadius:12, borderBottomRightRadius:12, height:50, justifyContent:'center'}}><Calendar size={24} color="#fff" /></TouchableOpacity></View></View><TouchableOpacity onPress={saveTaskDetail} style={[styles.createBtn, {backgroundColor: COLORS.primary, marginTop:10}]}><Text style={{color:'#fff', fontWeight:'bold'}}>{t('save')}</Text></TouchableOpacity></View>)}</View></Modal>
      <Modal visible={isNetworkModalOpen} animationType="slide" presentationStyle="pageSheet"><View style={[styles.container, {backgroundColor: currentColors.bg, padding: 20}]}><View style={{flexDirection:'row', justifyContent:'space-between', alignItems:'center', marginBottom:20}}><Text style={{fontSize:24, fontWeight:'bold', color: currentColors.text}}>{t('connections')}</Text><TouchableOpacity onPress={() => setIsNetworkModalOpen(false)}><Text style={{color: COLORS.primary, fontWeight:'bold'}}>{t('close')}</Text></TouchableOpacity></View><View style={{flexDirection:'row', marginBottom:20, backgroundColor: currentColors.surface, borderRadius:12, padding:4}}><TouchableOpacity onPress={()=>setNetworkTab('ommio')} style={{flex:1, padding:8, alignItems:'center', borderRadius:10, backgroundColor: networkTab==='ommio'? (isDark?'#334155':'#e2e8f0') : 'transparent'}}><Text style={{fontWeight:'bold', color:currentColors.text}}>Ommio</Text></TouchableOpacity><TouchableOpacity onPress={()=>{ setNetworkTab('contacts'); fetchDeviceContacts(); }} style={{flex:1, padding:8, alignItems:'center', borderRadius:10, backgroundColor: networkTab==='contacts'? (isDark?'#334155':'#e2e8f0') : 'transparent'}}><Text style={{fontWeight:'bold', color:currentColors.text}}>{t('find_from_contacts')}</Text></TouchableOpacity></View>{networkTab === 'ommio' ? (<><View style={{flexDirection:'row', gap:10, marginBottom:20}}><TextInput value={searchUsername} onChangeText={setSearchUsername} placeholder={t('search_username')} placeholderTextColor={currentColors.subText} style={[styles.authInput, {backgroundColor: currentColors.surface, color: currentColors.text, height: 50, flex:1, borderRadius:12, paddingHorizontal:15}]} autoCapitalize='none' /><TouchableOpacity onPress={sendFriendRequest} style={{backgroundColor: COLORS.primary, width:50, borderRadius:12, alignItems:'center', justifyContent:'center'}}><UserPlus size={24} color="#fff" /></TouchableOpacity></View>{friendRequests.length > 0 && <View style={{marginBottom:20}}>{friendRequests.map(req => (<View key={req.id} style={{backgroundColor: currentColors.surface, padding:15, borderRadius:16, marginBottom:10, flexDirection:'row', justifyContent:'space-between', alignItems:'center', borderLeftWidth:4, borderLeftColor:COLORS.warning}}><View><Text style={{color: currentColors.text, fontWeight:'bold'}}>{req.fromUsername}</Text></View><View style={{flexDirection:'row', gap:10}}><TouchableOpacity onPress={() => rejectRequest(req.id)}><XCircle size={28} color={COLORS.danger} /></TouchableOpacity><TouchableOpacity onPress={() => acceptRequest(req)}><UserCheck size={28} color={COLORS.success} /></TouchableOpacity></View></View>))}</View>}<FlatList data={contacts} keyExtractor={item => item.uid} renderItem={({item}) => { const contactCat = categories.find(c => c.id === item.defaultCategoryId); const catColor = contactCat ? CATEGORY_COLORS.find(c => c.id === contactCat.color) : null; return (<View style={{backgroundColor: currentColors.surface, padding:15, borderRadius:16, marginBottom:10}}><View style={{flexDirection:'row', justifyContent:'space-between', alignItems:'center', marginBottom:10}}><View><Text style={{color: currentColors.text, fontWeight:'bold', fontSize:16}}>{item.username}</Text><Text style={{color: currentColors.subText, fontSize:12}}>GÃ¶rev Atama Ä°zni:</Text></View><View style={{flexDirection:'row', alignItems:'center', gap:5}}><Text style={{fontSize:12, color: item.canAssignToMe ? COLORS.success : currentColors.subText}}>{item.canAssignToMe ? "AÃ‡IK" : "KAPALI"}</Text><Switch value={item.canAssignToMe} onValueChange={() => togglePermission(item)} trackColor={{false:"#cbd5e1", true:"#10b981"}} /></View></View><Text style={{fontSize:10, color:currentColors.subText, marginBottom:5}}>Bu kiÅŸiden gelen gÃ¶revleri ÅŸuraya ekle:</Text><ScrollView horizontal showsHorizontalScrollIndicator={false}>{categories.map(cat => { const cc = CATEGORY_COLORS.find(c=>c.id===cat.color)||CATEGORY_COLORS[0]; const isSelected = item.defaultCategoryId === cat.id; return (<TouchableOpacity key={cat.id} onPress={() => setContactCategory(item, cat.id)} style={{flexDirection:'row', alignItems:'center', gap:5, padding:5, paddingHorizontal:10, borderRadius:12, marginRight:5, backgroundColor: isSelected ? cc.bg : 'transparent', borderWidth:1, borderColor: isSelected ? cc.hex : (isDark?'#334155':'#e2e8f0')}}><View style={{width:6, height:6, borderRadius:3, backgroundColor: cc.hex}} /><Text style={{fontSize:10, color: isSelected ? cc.hex : currentColors.subText, fontWeight:'bold'}}>{cat.name}</Text></TouchableOpacity>)})}</ScrollView></View>)}} ListEmptyComponent={<Text style={{textAlign:'center', color: currentColors.subText, marginTop:20}}>{t('no_users')}</Text>} /></>) : (<FlatList data={deviceContacts} keyExtractor={item => item.id} renderItem={({item}) => (<View style={{backgroundColor: currentColors.surface, padding:15, borderRadius:16, marginBottom:10, flexDirection:'row', justifyContent:'space-between', alignItems:'center'}}><View><Text style={{color: currentColors.text, fontWeight:'bold'}}>{item.name}</Text><Text style={{color: currentColors.subText, fontSize:12}}>{item.phoneNumber}</Text></View><TouchableOpacity onPress={() => inviteContact(item.phoneNumber)} style={{backgroundColor: '#eff6ff', padding:8, borderRadius:8, flexDirection:'row', alignItems:'center', gap:5}}><Share2 size={16} color={COLORS.primary} /><Text style={{color: COLORS.primary, fontSize:12, fontWeight:'bold'}}>Davet Et</Text></TouchableOpacity></View>)} ListEmptyComponent={<Text style={{textAlign:'center', color: currentColors.subText, marginTop:20}}>{t('contacts_loading_or_denied')}</Text>} />)}</View></Modal>
      <Modal visible={isLangModalOpen} transparent animationType="fade"><View style={styles.modalBackdrop}><View style={[styles.catModal, { backgroundColor: currentColors.surface, maxHeight: '80%' }]}><Text style={[styles.catModalTitle, {color: currentColors.text}]}>{t('language')}</Text><FlatList data={LANGUAGES} keyExtractor={item => item.code} renderItem={({item}) => (<TouchableOpacity onPress={() => { setLang(item.code as LangCode); setIsLangModalOpen(false); }} style={{flexDirection:'row', alignItems:'center', padding:15, borderBottomWidth:1, borderColor: isDark ? '#334155' : '#f1f5f9'}}><Text style={{fontSize:24, marginRight:15}}>{item.flag}</Text><Text style={{fontSize:16, color: currentColors.text, fontWeight: lang === item.code ? 'bold' : 'normal'}}>{item.label}</Text>{lang === item.code && <Check size={18} color={COLORS.success} style={{marginLeft:'auto'}} />}</TouchableOpacity>)} /><TouchableOpacity onPress={() => setIsLangModalOpen(false)} style={{marginTop:15, padding:10, alignItems:'center'}}><Text style={{color:COLORS.danger, fontWeight:'bold'}}>{t('cancel')}</Text></TouchableOpacity></View></View></Modal>
      <Modal visible={!!activeAlarmTask} transparent animationType="slide"><View style={styles.alarmOverlay}><View style={[styles.alarmCard, { backgroundColor: currentColors.surface }]}><Text style={[styles.alarmTitle, {color: currentColors.text}]}>{t('alarm')}</Text><Text style={{color: currentColors.text}}>{activeAlarmTask?.text}</Text><TouchableOpacity onPress={() => setActiveAlarmTask(null)} style={styles.alarmCloseBtn}><Text style={{color:'#fff'}}>{t('close')}</Text></TouchableOpacity></View></View></Modal>
     <Modal visible={showOnboarding} animationType="fade">
    <View style={{flex:1, backgroundColor: COLORS.primary, padding: 20, justifyContent:'center', alignItems:'center'}}>
        {onboardingStep === 0 && (
            <View style={{alignItems:'center', gap:20}}>
                <View style={{width:120, height:120, backgroundColor:'rgba(255,255,255,0.2)', borderRadius:60, alignItems:'center', justifyContent:'center'}}>
                    <ListTodo size={60} color="#fff" />
                </View>
                <Text style={{fontSize:28, fontWeight:'bold', color:'#fff', textAlign:'center'}}>HoÅŸ Geldin!</Text>
                <Text style={{color:'#fff', textAlign:'center', fontSize:16}}>Ommio ile gÃ¶revlerini organize et, hayatÄ±nÄ± dÃ¼zene sok. BaÅŸlamak iÃ§in hazÄ±rsan kaydÄ±r!</Text>
            </View>
        )}
        {onboardingStep === 1 && (
            <View style={{alignItems:'center', gap:20}}>
                 <View style={{width:120, height:120, backgroundColor:'rgba(255,255,255,0.2)', borderRadius:60, alignItems:'center', justifyContent:'center'}}>
                    <Repeat size={60} color="#fff" />
                </View>
                <Text style={{fontSize:28, fontWeight:'bold', color:'#fff', textAlign:'center'}}>AlÄ±ÅŸkanlÄ±klar Kazan</Text>
                <Text style={{color:'#fff', textAlign:'center', fontSize:16}}>Her gÃ¼n %1 daha iyi ol. Zinciri kÄ±rma ve yeni alÄ±ÅŸkanlÄ±klarÄ±nÄ± takip et.</Text>
            </View>
        )}
        {onboardingStep === 2 && (
            <View style={{alignItems:'center', gap:20}}>
                 <View style={{width:120, height:120, backgroundColor:'rgba(255,255,255,0.2)', borderRadius:60, alignItems:'center', justifyContent:'center'}}>
                    <Users size={60} color="#fff" />
                </View>
                <Text style={{fontSize:28, fontWeight:'bold', color:'#fff', textAlign:'center'}}>Sosyal Ol</Text>
                <Text style={{color:'#fff', textAlign:'center', fontSize:16}}>ArkadaÅŸlarÄ±nla gÃ¶rev paylaÅŸ, sohbet et ve birbirinizi motive edin.</Text>
            </View>
        )}

        {/* Ä°LERLEME BUTONLARI */}
        <View style={{position:'absolute', bottom: 50, flexDirection:'row', width:'100%', justifyContent:'space-between', alignItems:'center'}}>
             <View style={{flexDirection:'row', gap:5}}>
                {[0,1,2].map(i => <View key={i} style={{width:8, height:8, borderRadius:4, backgroundColor: i===onboardingStep?'#fff':'rgba(255,255,255,0.3)'}} />)}
             </View>
             <TouchableOpacity onPress={() => {
                 if(onboardingStep < 2) setOnboardingStep(onboardingStep+1);
                 else setShowOnboarding(false);
             }} style={{backgroundColor:'#fff', paddingHorizontal:20, paddingVertical:10, borderRadius:20}}>
                <Text style={{color:COLORS.primary, fontWeight:'bold'}}>{onboardingStep === 2 ? 'BaÅŸla' : 'Ä°leri'}</Text>
             </TouchableOpacity>
        </View>
    </View>
</Modal>
      {/* KATEGORÄ° YÃ–NETÄ°M MODALI */}
<Modal visible={isCategoryModalOpen} transparent animationType="fade">
    <View style={styles.modalBackdrop}>
        <View style={[styles.catModal, { backgroundColor: currentColors.surface }]}>
            <View style={{ flexDirection: 'row', justifyContent: 'space-between', marginBottom: 15 }}>
            
                <Text style={{ fontSize: 18, fontWeight: 'bold', color: currentColors.text }}>{t('categories_title')}</Text>
                <TouchableOpacity onPress={() => setIsCategoryModalOpen(false)}>
                    <X size={24} color={currentColors.subText} />
                </TouchableOpacity>
            </View>
            
            <ScrollView style={{ maxHeight: 300 }} showsVerticalScrollIndicator={false}>
                {categories.map((cat) => (
                    <View key={cat.id} style={{ flexDirection: 'row', alignItems: 'center', justifyContent: 'space-between', paddingVertical: 12, borderBottomWidth: 1, borderColor: isDark ? '#334155' : '#f1f5f9' }}>
                        <View style={{ flexDirection: 'row', alignItems: 'center', gap: 10 }}>
                            <View style={{ width: 12, height: 12, borderRadius: 6, backgroundColor: CATEGORY_COLORS.find(c => c.id === cat.color)?.hex || 'gray' }} />
                            <Text style={{ fontSize: 16, color: currentColors.text }}>{cat.name}</Text>
                        </View>
                        <TouchableOpacity onPress={() => handleDeleteCategory(cat.id)} style={{ padding: 5 }}>
                            <Trash2 size={18} color={COLORS.danger} />
                        </TouchableOpacity>
                    </View>
                ))}
            </ScrollView>

            {/* Yeni Ekleme KÄ±smÄ± */}
            <View style={{ marginTop: 20, flexDirection: 'row', gap: 10 }}>
                <TextInput
                    value={newCategoryName}
                    onChangeText={setNewCategoryName}
                    placeholder={t('category_name_placeholder')}
                    placeholderTextColor={currentColors.subText}
                    style={[styles.input, { flex: 1, height: 45, color: currentColors.text, backgroundColor: isDark ? '#1e293b' : '#f8fafc' }]}
                />
                <View style={{marginBottom: 10}}>
                
                <ScrollView horizontal showsHorizontalScrollIndicator={false}>
                    {CATEGORY_PALETTE.map(colorName => {
                        const colorHex = CATEGORY_COLORS.find(c=>c.id===colorName)?.hex || '#000';
                        const isSelected = newCategoryColor === colorName;
                        return (
                            <TouchableOpacity key={colorName} onPress={()=>setNewCategoryColor(colorName)} style={{width:45, height:45, alignItems: 'center', justifyContent: 'center',borderRadius:24, backgroundColor:colorHex, marginRight:10, borderWidth:2, borderColor: isSelected ? currentColors.text : 'transparent'}}>
                                {isSelected && <Check size={16} color="#fff" style={{alignSelf:'center', marginTop:5}}/>}
                            </TouchableOpacity>
                        )
                    })}
                </ScrollView>
            </View>
                <TouchableOpacity onPress={handleAddCategory} style={{ backgroundColor: COLORS.success, width: 45, height: 45, borderRadius: 12, alignItems: 'center', justifyContent: 'center' }}>
                    <Plus size={24} color="#fff" />
                </TouchableOpacity>
            </View>
        </View>
    </View>
</Modal>     
    </SafeAreaView>
    </KeyboardAvoidingView>
  );
}

const styles = StyleSheet.create({
  container: { flex: 1 },
  header: { padding: 20, flexDirection: 'row', justifyContent:'space-between', alignItems:'center' },
  card: { padding: 20, borderRadius: 16, shadowColor: "#000", shadowOpacity: 0.05, elevation: 2 },
  input: { backgroundColor: 'rgba(0,0,0,0.05)', padding: 15, borderRadius: 12, fontSize: 16 },
  btn: { backgroundColor: COLORS.primary, padding: 15, borderRadius: 12, alignItems: 'center' },
  greeting: { fontSize: 14, fontWeight: '600', textTransform: 'uppercase', letterSpacing: 1 },
  appTitle: { fontSize: 28, fontWeight: '900' },
  tabBar: { flexDirection: 'row', justifyContent: 'space-around', paddingBottom: 20, paddingTop: 10, borderTopWidth: 1, height: 80, alignItems:'center' },
  checkbox: { width: 24, height: 24, borderRadius: 12, borderWidth: 2, borderColor: '#cbd5e1' },
  menuItem: { flexDirection:'row', alignItems:'center', justifyContent:'space-between', paddingVertical:15, borderBottomWidth:1, borderColor:'rgba(0,0,0,0.05)' },
  menuText: { fontSize:16, fontWeight:'500', marginLeft:10, flex:1 },
  pill: { paddingHorizontal: 15, paddingVertical: 8, borderRadius: 20, borderWidth: 1, borderColor: '#e2e8f0', marginRight: 10 },
  dateNavContainer: { flexDirection: 'row', alignItems: 'center', justifyContent: 'space-between', paddingHorizontal: 24, marginBottom: 20 },
  dateDisplay: { flexDirection: 'row', alignItems: 'center', backgroundColor: 'rgba(99, 102, 241, 0.1)', paddingHorizontal: 16, paddingVertical: 8, borderRadius: 20 },
  dateText: { fontWeight: '700', fontSize: 14 },
  todayBadge: { marginLeft: 8, backgroundColor: COLORS.primary, paddingHorizontal: 6, paddingVertical: 2, borderRadius: 4 },
  todayText: { color: '#fff', fontSize: 10, fontWeight: 'bold' },
  dateArrow: { padding: 5 },
  content: { flex: 1, paddingHorizontal: 24 },
  emptyState: { alignItems: 'center', justifyContent: 'center', marginTop: 60 },
  emptyIconBox: { width: 80, height: 80, borderRadius: 40, alignItems: 'center', justifyContent: 'center', marginBottom: 20 },
  emptyTitle: { fontSize: 20, fontWeight: 'bold', marginBottom: 10 },
  emptyDesc: { textAlign: 'center', color: '#94a3b8', lineHeight: 20 },
  taskCard: { padding: 16, borderRadius: 24, marginBottom: 12, shadowColor: "#000", shadowOffset: { width: 0, height: 4 }, shadowOpacity: 0.05, shadowRadius: 10, elevation: 2 },
  checkBox: { width: 24, height: 24, borderRadius: 12, borderWidth: 2, alignItems: 'center', justifyContent: 'center', marginRight: 16 },
  taskText: { fontSize: 16, fontWeight: '600' },
  taskMeta: { flexDirection: 'row', alignItems: 'center', gap: 8, marginTop: 6 },
  miniBadge: { flexDirection: 'row', alignItems: 'center', gap: 4, paddingHorizontal: 8, paddingVertical: 3, borderRadius: 10 },
  metaItem: { flexDirection: 'row', alignItems: 'center', gap: 4 },
floatingInputWrapper: {position: 'absolute', bottom: 90, left: 20, right: 20, borderRadius: 24, padding: 10, shadowColor: "#000", shadowOffset: { width: 0, height: 10 }, shadowOpacity: 0.15, shadowRadius: 20, elevation: 10, overflow: 'hidden'},  
  inputMainRow: { flexDirection: 'row', alignItems: 'center', gap: 10 },
  mainInput: { flex: 1, fontSize: 16, height: 40, fontWeight: '500' },
  sendBtn: { width: 44, height: 44, borderRadius: 22, alignItems: 'center', justifyContent: 'center' },
  expandBtn: { padding: 8 },
  expandedOptions: { paddingBottom: 10, marginBottom: 10 },
  timeToggle: { flexDirection: 'row', alignItems: 'center', gap: 5, paddingHorizontal: 8, paddingVertical: 4, borderRadius: 12, borderWidth: 1, borderColor: '#e2e8f0' },
  statsHero: { padding: 30, borderRadius: 32, marginBottom: 20 },
  activeDot: { width: 4, height: 4, borderRadius: 2, backgroundColor: COLORS.primary, marginTop: 4 },
  cardTitle: { fontSize: 16, fontWeight: 'bold', marginBottom: 15 },
  settingBtn: { flexDirection: 'row', alignItems: 'center', gap: 8, paddingHorizontal: 15, paddingVertical: 10, borderRadius: 12, borderWidth: 1, borderColor: '#e2e8f0' },
  settingBtnActive: { borderColor: COLORS.primary, backgroundColor: '#e0e7ff' },
  authInputRow: { flexDirection: 'row', alignItems: 'center', borderWidth: 1, borderColor: '#e2e8f0', borderRadius: 12, paddingHorizontal: 15, marginBottom: 15, height: 50 },
  authInput: { flex: 1, marginLeft: 10, height: '100%' },
  createBtn: { backgroundColor: COLORS.primary, padding: 15, borderRadius: 12, alignItems: 'center' },
  socialBtn: { padding: 15, borderRadius: 12, alignItems: 'center', borderWidth: 1, borderColor: '#e2e8f0' },
  alarmOverlay: { flex: 1, backgroundColor: 'rgba(99, 102, 241, 0.95)', justifyContent: 'center', alignItems: 'center' },
  alarmCard: { width: '80%', padding: 30, borderRadius: 30, alignItems: 'center' },
  alarmTitle: { fontSize: 22, fontWeight: '900', marginBottom: 10 },
  alarmCloseBtn: { backgroundColor: COLORS.primary, paddingHorizontal: 30, paddingVertical: 12, borderRadius: 16, marginTop: 20 },
  smallInput: { fontSize: 12, padding: 8, borderRadius: 8, borderWidth: 1, borderColor: '#e2e8f0', height: 36 },
  iconToggle: { width: 36, height: 36, borderRadius: 18, borderWidth: 1, borderColor: '#e2e8f0', alignItems: 'center', justifyContent: 'center' },
  tinyInput: { fontSize: 12, fontWeight: 'bold', width: 40, padding: 0, textAlign: 'center', borderBottomWidth: 1 },
  dateBtn: { flexDirection: 'row', alignItems: 'center', gap: 6, backgroundColor: '#eff6ff', padding: 8, borderRadius: 8, marginTop: 5 },
  modalBackdrop: { flex: 1, backgroundColor: 'rgba(0,0,0,0.3)', justifyContent: 'center', alignItems: 'center' },
  catModal: { width: '80%', padding: 20, borderRadius: 24 },
  catModalTitle: { fontSize: 18, fontWeight: 'bold', marginBottom: 15 },
});